<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Mongo::Grid::FSBucket
  
    &mdash; mongo-2.12.0.rc0
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Mongo::Grid::FSBucket";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (F)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Mongo.html" title="Mongo (module)">Mongo</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Grid.html" title="Mongo::Grid (module)">Grid</a></span></span>
     &raquo; 
    <span class="title">FSBucket</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Mongo::Grid::FSBucket
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Mongo::Grid::FSBucket</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  <dl>
      <dt>Extended by:</dt>
      <dd>Forwardable</dd>
  </dl>
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/mongo/grid/fs_bucket.rb<span class="defines">,<br />
  lib/mongo/grid/stream.rb,<br /> lib/mongo/grid/stream/read.rb,<br /> lib/mongo/grid/stream/write.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Represents a view of the GridFS in the database.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="FSBucket/Stream.html" title="Mongo::Grid::FSBucket::Stream (module)">Stream</a></span>
    
  
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="DEFAULT_ROOT-constant" class="">DEFAULT_ROOT =
          <div class="docstring">
  <div class="discussion">
    
<p>The default root prefix.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>fs</span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="CHUNKS_INDEX-constant" class="">CHUNKS_INDEX =
          <div class="docstring">
  <div class="discussion">
    
<p>The specification for the chunks collection index.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span> <span class='symbol'>:files_id</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='comma'>,</span> <span class='symbol'>:n</span> <span class='op'>=&gt;</span> <span class='int'>1</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="FILES_INDEX-constant" class="">FILES_INDEX =
          <div class="docstring">
  <div class="discussion">
    
<p>The specification for the files collection index.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span> <span class='label'>filename:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>uploadDate:</span> <span class='int'>1</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#chunks_collection-instance_method" title="#chunks_collection (instance method)">#<strong>chunks_collection</strong>  &#x21d2; Collection </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Chunks_collection The chunks collection.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#database-instance_method" title="#database (instance method)">#<strong>database</strong>  &#x21d2; Database </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Database The database.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#files_collection-instance_method" title="#files_collection (instance method)">#<strong>files_collection</strong>  &#x21d2; Collection </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Files_collection The files collection.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#options-instance_method" title="#options (instance method)">#<strong>options</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Options The FSBucket options.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete-instance_method" title="#delete (instance method)">#<strong>delete</strong>(id)  &#x21d2; Result </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove a single file, identified by its id from the GridFS.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_one-instance_method" title="#delete_one (instance method)">#<strong>delete_one</strong>(file)  &#x21d2; Result </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove a single file from the GridFS.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#download_to_stream-instance_method" title="#download_to_stream (instance method)">#<strong>download_to_stream</strong>(id, io)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Downloads the contents of the file specified by id and writes them to the destination io object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#download_to_stream_by_name-instance_method" title="#download_to_stream_by_name (instance method)">#<strong>download_to_stream_by_name</strong>(filename, io, opts = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Downloads the contents of the stored file specified by filename and by the revision in options and writes the contents to the destination io object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find-instance_method" title="#find (instance method)">#<strong>find</strong>(selector = nil, options = {})  &#x21d2; CollectionView </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Find files collection documents matching a given selector.</p>
</div></span>
  
</li>

      
        <li class="public deprecated">
  <span class="summary_signature">
    
      <a href="#find_one-instance_method" title="#find_one (instance method)">#<strong>find_one</strong>(selector = nil)  &#x21d2; Grid::File </a>
    

    
  </span>
  
  
  
  
  
  <span class="deprecated note title">deprecated</span>
  

  
    <span class="summary_desc"><strong>Deprecated.</strong> <div class='inline'>
<p>Please use #find instead with a limit of -1. Will be removed in version 3.0.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(database, options = {})  &#x21d2; FSBucket </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create the GridFS.</p>
</div></span>
  
</li>

      
        <li class="public deprecated">
  <span class="summary_signature">
    
      <a href="#insert_one-instance_method" title="#insert_one (instance method)">#<strong>insert_one</strong>(file)  &#x21d2; BSON::ObjectId </a>
    

    
  </span>
  
  
  
  
  
  <span class="deprecated note title">deprecated</span>
  

  
    <span class="summary_desc"><strong>Deprecated.</strong> <div class='inline'>
<p>Please use #upload_from_stream or #open_upload_stream instead. Will be removed in version 3.0.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#open_download_stream-instance_method" title="#open_download_stream (instance method)">#<strong>open_download_stream</strong>(id, options = nil) {|The| ... } &#x21d2; Stream::Read </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Opens a stream from which a file can be downloaded, specified by id.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#open_download_stream_by_name-instance_method" title="#open_download_stream_by_name (instance method)">#<strong>open_download_stream_by_name</strong>(filename, opts = {}) {|The| ... } &#x21d2; Stream::Read </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Opens a stream from which the application can read the contents of the stored file specified by filename and the revision in options.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#open_upload_stream-instance_method" title="#open_upload_stream (instance method)">#<strong>open_upload_stream</strong>(filename, opts = {}) {|The| ... } &#x21d2; Stream::Write </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Opens an upload stream to GridFS to which the contents of a user file came be written.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prefix-instance_method" title="#prefix (instance method)">#<strong>prefix</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the prefix for the GridFS.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_preference-instance_method" title="#read_preference (instance method)">#<strong>read_preference</strong>  &#x21d2; Mongo::ServerSelector </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the read preference.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#upload_from_stream-instance_method" title="#upload_from_stream (instance method)">#<strong>upload_from_stream</strong>(filename, io, opts = {})  &#x21d2; BSON::ObjectId </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Uploads a user file to a GridFS bucket.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#write_concern-instance_method" title="#write_concern (instance method)">#<strong>write_concern</strong>  &#x21d2; Mongo::WriteConcern </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the write concern.</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(database, options = {})  &#x21d2; <tt><span class='object_link'><a href="" title="Mongo::Grid::FSBucket (class)">FSBucket</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create the GridFS.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Create the GridFS.</p>
</div></p>
      
      <pre class="example code"><code><span class='const'><span class='object_link'><a href="../Grid.html" title="Mongo::Grid (module)">Grid</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Mongo::Grid::FSBucket (class)">FSBucket</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_database'>database</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>database</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Database.html" title="Mongo::Database (class)">Database</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The database the files reside in.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The GridFS options.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:fs_name</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The prefix for the files and chunks collections.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:bucket_name</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The prefix for the files and chunks collections.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:chunk_size</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Override the default chunk size.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:read</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The read preference.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:session</span>
          <span class="type">(<tt><span class='object_link'><a href="../Session.html" title="Mongo::Session (class)">Session</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The session to use.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:write</span>
          <span class="type">(<tt>Hash</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Deprecated. Equivalent to :write_concern option.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:write_concern</span>
          <span class="type">(<tt>Hash</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The write concern options. Can be :w =&gt; Integer|String, :fsync =&gt; Boolean, :j =&gt; Boolean.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


156
157
158
159
160
161
162
163
164
165
166
167
168
169</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 156</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_database'>database</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='ivar'>@database</span> <span class='op'>=</span> <span class='id identifier rubyid_database'>database</span>
  <span class='ivar'>@options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
<span class='embdoc_beg'>=begin WriteConcern object support
</span><span class='embdoc'>  if @options[:write_concern].is_a?(WriteConcern::Base)
</span><span class='embdoc'>    # Cache the instance so that we do not needlessly reconstruct it.
</span><span class='embdoc'>    @write_concern = @options[:write_concern]
</span><span class='embdoc'>    @options[:write_concern] = @write_concern.options
</span><span class='embdoc'>  end
</span><span class='embdoc_end'>=end
</span>  <span class='ivar'>@options</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='ivar'>@chunks_collection</span> <span class='op'>=</span> <span class='id identifier rubyid_database'>database</span><span class='lbracket'>[</span><span class='id identifier rubyid_chunks_name'>chunks_name</span><span class='rbracket'>]</span>
  <span class='ivar'>@files_collection</span> <span class='op'>=</span> <span class='id identifier rubyid_database'>database</span><span class='lbracket'>[</span><span class='id identifier rubyid_files_name'>files_name</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="chunks_collection-instance_method">
  
    #<strong>chunks_collection</strong>  &#x21d2; <tt><span class='object_link'><a href="../Collection.html" title="Mongo::Collection (class)">Collection</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns chunks_collection The chunks collection.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Collection.html" title="Mongo::Collection (class)">Collection</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>chunks_collection The chunks collection.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


42
43
44</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 42</span>

<span class='kw'>def</span> <span class='id identifier rubyid_chunks_collection'>chunks_collection</span>
  <span class='ivar'>@chunks_collection</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="database-instance_method">
  
    #<strong>database</strong>  &#x21d2; <tt><span class='object_link'><a href="../Database.html" title="Mongo::Database (class)">Database</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns database The database.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Database.html" title="Mongo::Database (class)">Database</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>database The database.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


47
48
49</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 47</span>

<span class='kw'>def</span> <span class='id identifier rubyid_database'>database</span>
  <span class='ivar'>@database</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="files_collection-instance_method">
  
    #<strong>files_collection</strong>  &#x21d2; <tt><span class='object_link'><a href="../Collection.html" title="Mongo::Collection (class)">Collection</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns files_collection The files collection.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Collection.html" title="Mongo::Collection (class)">Collection</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>files_collection The files collection.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 52</span>

<span class='kw'>def</span> <span class='id identifier rubyid_files_collection'>files_collection</span>
  <span class='ivar'>@files_collection</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="options-instance_method">
  
    #<strong>options</strong>  &#x21d2; <tt>Hash</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns options The FSBucket options.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>options The FSBucket options.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


57
58
59</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 57</span>

<span class='kw'>def</span> <span class='id identifier rubyid_options'>options</span>
  <span class='ivar'>@options</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="delete-instance_method">
  
    #<strong>delete</strong>(id)  &#x21d2; <tt>Result</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remove a single file, identified by its id from the GridFS.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Remove a file from the GridFS.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>BSON::ObjectId</tt>, <tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The id of the file to remove.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Result</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The result of the remove.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error/FileNotFound.html" title="Mongo::Error::FileNotFound (class)">Error::FileNotFound</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the file is not found.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


209
210
211
212
213
214</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 209</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_files_collection'>files_collection</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='symbol'>:_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='ivar'>@options</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_delete_one'>delete_one</span>
  <span class='id identifier rubyid_chunks_collection'>chunks_collection</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='symbol'>:files_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='ivar'>@options</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_delete_many'>delete_many</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../Error.html" title="Mongo::Error (class)">Error</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Error/FileNotFound.html" title="Mongo::Error::FileNotFound (class)">FileNotFound</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Error/FileNotFound.html#initialize-instance_method" title="Mongo::Error::FileNotFound#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='symbol'>:id</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_n'>n</span> <span class='op'>==</span> <span class='int'>0</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_one-instance_method">
  
    #<strong>delete_one</strong>(file)  &#x21d2; <tt>Result</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remove a single file from the GridFS.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Remove a file from the GridFS.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_delete_one'>delete_one</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>file</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="File.html" title="Mongo::Grid::File (class)">Grid::File</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The file to remove.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Result</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The result of the remove.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


193
194
195</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 193</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_one'>delete_one</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="download_to_stream-instance_method">
  
    #<strong>download_to_stream</strong>(id, io)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Downloads the contents of the file specified by id and writes them to the destination io object.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Download the file and write it to the io object.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_download_to_stream'>download_to_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_io'>io</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>BSON::ObjectId</tt>, <tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The id of the file to read.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>io</span>
      
      
        <span class='type'>(<tt>IO</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The io object to write to.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


254
255
256
257
258
259
260</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 254</span>

<span class='kw'>def</span> <span class='id identifier rubyid_download_to_stream'>download_to_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_io'>io</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_open_download_stream'>open_download_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_stream'>stream</span><span class='op'>|</span>
    <span class='id identifier rubyid_stream'>stream</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_chunk'>chunk</span><span class='op'>|</span>
      <span class='id identifier rubyid_io'>io</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_chunk'>chunk</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="download_to_stream_by_name-instance_method">
  
    #<strong>download_to_stream_by_name</strong>(filename, io, opts = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Downloads the contents of the stored file specified by filename and by the revision in options and writes the contents to the destination io object.</p>

<p>Revision numbers are defined as follows: 0 = the original stored file 1 = the first revision 2 = the second revision etc… -2 = the second most recent revision -1 = the most recent revision</p>

<p># @example Download the original file.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_download_to_stream_by_name'>download_to_stream_by_name</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some-file.txt</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='label'>revision:</span> <span class='int'>0</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Download the most recent revision.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_download_to_stream_by_name'>download_to_stream_by_name</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some-file.txt</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_io'>io</span><span class='rparen'>)</span></code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>Download the second revision of the stored file.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_download_to_stream_by_name'>download_to_stream_by_name</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some-file.txt</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='label'>revision:</span> <span class='int'>2</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>filename</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The file&#39;s name.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>io</span>
      
      
        <span class='type'>(<tt>IO</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The io object to write to.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Options for the download.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:revision</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The revision number of the file to download. Defaults to -1, the most recent version.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error/FileNotFound.html" title="Mongo::Error::FileNotFound (class)">Error::FileNotFound</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the file is not found.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error/InvalidFileRevision.html" title="Mongo::Error::InvalidFileRevision (class)">Error::InvalidFileRevision</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the requested revision is not found for the file.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


347
348
349</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 347</span>

<span class='kw'>def</span> <span class='id identifier rubyid_download_to_stream_by_name'>download_to_stream_by_name</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_download_to_stream'>download_to_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_open_download_stream_by_name'>open_download_stream_by_name</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_file_id'>file_id</span><span class='comma'>,</span> <span class='id identifier rubyid_io'>io</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find-instance_method">
  
    #<strong>find</strong>(selector = nil, options = {})  &#x21d2; <tt>CollectionView</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Find files collection documents matching a given selector.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Find files collection documents by a filename.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='label'>filename:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>file.txt</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>selector</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The selector to use in the find.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The options for the find.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:batch_size</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The number of documents returned in each batch of results from MongoDB.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:limit</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The max number of docs to return from the query.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:no_cursor_timeout</span>
          <span class="type">(<tt>true</tt>, <tt>false</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The server normally times out idle cursors after an inactivity period (10 minutes) to prevent excess memory use. Set this option to prevent that.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:skip</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The number of docs to skip before returning results.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:sort</span>
          <span class="type">(<tt>Hash</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The key and direction pairs by which the result set will be sorted.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>CollectionView</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The collection view.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88
89</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_selector'>selector</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>read:</span> <span class='id identifier rubyid_read_preference'>read_preference</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_read_preference'>read_preference</span>
  <span class='id identifier rubyid_files_collection'>files_collection</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_selector'>selector</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>||</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_one-instance_method">
  
    #<strong>find_one</strong>(selector = nil)  &#x21d2; <tt><span class='object_link'><a href="File.html" title="Mongo::Grid::File (class)">Grid::File</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <div class="note deprecated"><strong>Deprecated.</strong> <div class='inline'>
<p>Please use #find instead with a limit of -1. Will be removed in version 3.0.</p>
</div></div>

<p>Find a file in the GridFS.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Find a file by its id.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_find_one'>find_one</span><span class='lparen'>(</span><span class='label'>_id:</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span></code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>Find a file by its filename.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_find_one'>find_one</span><span class='lparen'>(</span><span class='label'>filename:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test.txt</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>selector</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The selector.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="File.html" title="Mongo::Grid::File (class)">Grid::File</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The file.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109
110
111
112</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 107</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_one'>find_one</span><span class='lparen'>(</span><span class='id identifier rubyid_selector'>selector</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_file_info'>file_info</span> <span class='op'>=</span> <span class='id identifier rubyid_files_collection'>files_collection</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_selector'>selector</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_file_info'>file_info</span>
  <span class='id identifier rubyid_chunks'>chunks</span> <span class='op'>=</span> <span class='id identifier rubyid_chunks_collection'>chunks_collection</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='symbol'>:files_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_file_info'>file_info</span><span class='lbracket'>[</span><span class='symbol'>:_id</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='lparen'>(</span><span class='symbol'>:n</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="../Grid.html" title="Mongo::Grid (module)">Grid</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="File.html" title="Mongo::Grid::File (class)">File</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="File.html#initialize-instance_method" title="Mongo::Grid::File#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_chunks'>chunks</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Options.html" title="Mongo::Options (module)">Options</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Options/Mapper.html" title="Mongo::Options::Mapper (module)">Mapper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_transform'><span class='object_link'><a href="../Options/Mapper.html#transform-instance_method" title="Mongo::Options::Mapper#transform (method)">transform</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_file_info'>file_info</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Grid.html" title="Mongo::Grid (module)">Grid</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="File.html" title="Mongo::Grid::File (class)">File</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="File/Info.html" title="Mongo::Grid::File::Info (class)">Info</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="File/Info.html#MAPPINGS-constant" title="Mongo::Grid::File::Info::MAPPINGS (constant)">MAPPINGS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_invert'>invert</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="insert_one-instance_method">
  
    #<strong>insert_one</strong>(file)  &#x21d2; <tt>BSON::ObjectId</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <div class="note deprecated"><strong>Deprecated.</strong> <div class='inline'>
<p>Please use #upload_from_stream or #open_upload_stream instead. Will be removed in version 3.0.</p>
</div></div>

<p>Insert a single file into the GridFS.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Insert a single file.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_insert_one'>insert_one</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>file</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="File.html" title="Mongo::Grid::File (class)">Grid::File</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The file to insert.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>BSON::ObjectId</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The file id.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


127
128
129
130
131
132</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 127</span>

<span class='kw'>def</span> <span class='id identifier rubyid_insert_one'>insert_one</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
  <span class='ivar'>@indexes</span> <span class='op'>||=</span> <span class='id identifier rubyid_ensure_indexes!'>ensure_indexes!</span>
  <span class='id identifier rubyid_chunks_collection'>chunks_collection</span><span class='period'>.</span><span class='id identifier rubyid_insert_many'>insert_many</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_chunks'>chunks</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_files_collection'>files_collection</span><span class='period'>.</span><span class='id identifier rubyid_insert_one'>insert_one</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="open_download_stream-instance_method">
  
    #<strong>open_download_stream</strong>(id, options = nil) {|The| ... } &#x21d2; <tt><span class='object_link'><a href="FSBucket/Stream/Read.html" title="Mongo::Grid::FSBucket::Stream::Read (class)">Stream::Read</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Opens a stream from which a file can be downloaded, specified by id.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Open a stream from which a file can be downloaded.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_open_download_stream'>open_download_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>BSON::ObjectId</tt>, <tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The id of the file to read.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The options.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:file_info_doc</span>
          <span class="type">(<tt>BSON::Document</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>For internal driver use only. A BSON document to use as file information.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>The</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>read stream.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="FSBucket/Stream/Read.html" title="Mongo::Grid::FSBucket::Stream::Read (class)">Stream::Read</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The stream to read from.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


232
233
234
235
236
237
238
239
240
241
242</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 232</span>

<span class='kw'>def</span> <span class='id identifier rubyid_open_download_stream'>open_download_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_read_stream'>read_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_stream'>stream</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
      <span class='kw'>begin</span>
        <span class='kw'>yield</span> <span class='id identifier rubyid_stream'>stream</span>
      <span class='kw'>ensure</span>
        <span class='id identifier rubyid_stream'>stream</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="open_download_stream_by_name-instance_method">
  
    #<strong>open_download_stream_by_name</strong>(filename, opts = {}) {|The| ... } &#x21d2; <tt><span class='object_link'><a href="FSBucket/Stream/Read.html" title="Mongo::Grid::FSBucket::Stream::Read (class)">Stream::Read</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Opens a stream from which the application can read the contents of the stored file specified by filename and the revision in options.</p>

<p>Revision numbers are defined as follows: 0 = the original stored file 1 = the first revision 2 = the second revision etc… -2 = the second most recent revision -1 = the most recent revision</p>

<p># @example Open a stream to download the original file.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_open_download_stream_by_name'>open_download_stream_by_name</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some-file.txt</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>revision:</span> <span class='int'>0</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Open a stream to download the most recent revision.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_open_download_stream_by_name'>open_download_stream_by_name</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some-file.txt</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>Open a stream to download the second revision of the stored file.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_open_download_stream_by_name'>open_download_stream_by_name</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some-file.txt</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>revision:</span> <span class='int'>2</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>filename</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The file&#39;s name.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Options for the download.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:revision</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The revision number of the file to download. Defaults to -1, the most recent version.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>The</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>read stream.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="FSBucket/Stream/Read.html" title="Mongo::Grid::FSBucket::Stream::Read (class)">Stream::Read</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The stream to read from.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error/FileNotFound.html" title="Mongo::Error::FileNotFound (class)">Error::FileNotFound</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the file is not found.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error/InvalidFileRevision.html" title="Mongo::Error::InvalidFileRevision (class)">Error::InvalidFileRevision</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the requested revision is not found for the file.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 296</span>

<span class='kw'>def</span> <span class='id identifier rubyid_open_download_stream_by_name'>open_download_stream_by_name</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_revision'>revision</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:revision</span><span class='comma'>,</span> <span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_revision'>revision</span> <span class='op'>&lt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_skip'>skip</span> <span class='op'>=</span> <span class='id identifier rubyid_revision'>revision</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span> <span class='op'>-</span> <span class='int'>1</span>
    <span class='id identifier rubyid_sort'>sort</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uploadDate</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='const'><span class='object_link'><a href="../../Mongo.html" title="Mongo (module)">Mongo</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Index.html" title="Mongo::Index (module)">Index</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Index.html#DESCENDING-constant" title="Mongo::Index::DESCENDING (constant)">DESCENDING</a></span></span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_skip'>skip</span> <span class='op'>=</span> <span class='id identifier rubyid_revision'>revision</span>
    <span class='id identifier rubyid_sort'>sort</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uploadDate</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='const'><span class='object_link'><a href="../../Mongo.html" title="Mongo (module)">Mongo</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Index.html" title="Mongo::Index (module)">Index</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Index.html#ASCENDING-constant" title="Mongo::Index::ASCENDING (constant)">ASCENDING</a></span></span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_file_info_doc'>file_info_doc</span> <span class='op'>=</span> <span class='id identifier rubyid_files_collection'>files_collection</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='label'>filename:</span> <span class='id identifier rubyid_filename'>filename</span><span class='rbrace'>}</span> <span class='comma'>,</span>
                                     <span class='label'>sort:</span> <span class='id identifier rubyid_sort'>sort</span><span class='comma'>,</span>
                                     <span class='label'>skip:</span> <span class='id identifier rubyid_skip'>skip</span><span class='comma'>,</span>
                                     <span class='label'>limit:</span> <span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_file_info_doc'>file_info_doc</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../Error.html" title="Mongo::Error (class)">Error</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Error/FileNotFound.html" title="Mongo::Error::FileNotFound (class)">FileNotFound</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Error/FileNotFound.html#initialize-instance_method" title="Mongo::Error::FileNotFound#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='symbol'>:filename</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:revision</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../Error.html" title="Mongo::Error (class)">Error</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Error/InvalidFileRevision.html" title="Mongo::Error::InvalidFileRevision (class)">InvalidFileRevision</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Error/InvalidFileRevision.html#initialize-instance_method" title="Mongo::Error::InvalidFileRevision#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:revision</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_open_download_stream'>open_download_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_file_info_doc'>file_info_doc</span><span class='lbracket'>[</span><span class='symbol'>:_id</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>file_info_doc:</span> <span class='id identifier rubyid_file_info_doc'>file_info_doc</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="open_upload_stream-instance_method">
  
    #<strong>open_upload_stream</strong>(filename, opts = {}) {|The| ... } &#x21d2; <tt><span class='object_link'><a href="FSBucket/Stream/Write.html" title="Mongo::Grid::FSBucket::Stream::Write (class)">Stream::Write</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Opens an upload stream to GridFS to which the contents of a user file came be written.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Open a stream to which the contents of a file came be written.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_open_upload_stream'>open_upload_stream</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a-file.txt</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>filename</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The filename of the file to upload.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The options for the write stream.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a customizable set of options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:file_id</span>
          <span class="type">(<tt>Object</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>An optional unique file id. An ObjectId is generated otherwise.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:chunk_size</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Override the default chunk size.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:metadata</span>
          <span class="type">(<tt>Hash</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>User data for the &#39;metadata&#39; field of the files collection document.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:content_type</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The content type of the file. Deprecated, please use the metadata document instead.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:aliases</span>
          <span class="type">(<tt>Array&lt;String&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>A list of aliases. Deprecated, please use the metadata document instead.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>The</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>write stream.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="FSBucket/Stream/Write.html" title="Mongo::Grid::FSBucket::Stream::Write (class)">Stream::Write</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The write stream.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


377
378
379
380
381
382
383
384
385
386
387</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 377</span>

<span class='kw'>def</span> <span class='id identifier rubyid_open_upload_stream'>open_upload_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_write_stream'>write_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_stream'>stream</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
      <span class='kw'>begin</span>
        <span class='kw'>yield</span> <span class='id identifier rubyid_stream'>stream</span>
      <span class='kw'>ensure</span>
        <span class='id identifier rubyid_stream'>stream</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prefix-instance_method">
  
    #<strong>prefix</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the prefix for the GridFS</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Get the prefix.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_prefix'>prefix</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The GridFS prefix.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


179
180
181</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 179</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prefix'>prefix</span>
  <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:fs_name</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:bucket_name</span><span class='rbracket'>]</span><span class='op'>||</span> <span class='const'><span class='object_link'><a href="#DEFAULT_ROOT-constant" title="Mongo::Grid::FSBucket::DEFAULT_ROOT (constant)">DEFAULT_ROOT</a></span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_preference-instance_method">
  
    #<strong>read_preference</strong>  &#x21d2; <tt><span class='object_link'><a href="../ServerSelector.html" title="Mongo::ServerSelector (module)">Mongo::ServerSelector</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the read preference.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Get the read preference.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_read_preference'>read_preference</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../ServerSelector.html" title="Mongo::ServerSelector (module)">Mongo::ServerSelector</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The read preference.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


439
440
441</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 439</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_preference'>read_preference</span>
  <span class='ivar'>@read_preference</span> <span class='op'>||=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:read</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_database'>database</span><span class='period'>.</span><span class='id identifier rubyid_read_preference'>read_preference</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="upload_from_stream-instance_method">
  
    #<strong>upload_from_stream</strong>(filename, io, opts = {})  &#x21d2; <tt>BSON::ObjectId</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Uploads a user file to a GridFS bucket. Reads the contents of the user file from the source stream and uploads it as chunks in the chunks collection. After all the chunks have been uploaded, it creates a files collection document for the filename in the files collection.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Upload a file to the GridFS bucket.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_fs'>fs</span><span class='period'>.</span><span class='id identifier rubyid_upload_from_stream'>upload_from_stream</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a-file.txt</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>filename</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The filename of the file to upload.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>io</span>
      
      
        <span class='type'>(<tt>IO</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The source io stream to upload from.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The options for the write stream.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a customizable set of options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:file_id</span>
          <span class="type">(<tt>Object</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>An optional unique file id. An ObjectId is generated otherwise.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:chunk_size</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Override the default chunk size.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:metadata</span>
          <span class="type">(<tt>Hash</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>User data for the &#39;metadata&#39; field of the files collection document.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:content_type</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The content type of the file. Deprecated, please use the metadata document instead.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:aliases</span>
          <span class="type">(<tt>Array&lt;String&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>A list of aliases. Deprecated, please use the metadata document instead.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>BSON::ObjectId</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The ObjectId file id.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


417
418
419
420
421
422
423
424
425
426
427
428
429</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 417</span>

<span class='kw'>def</span> <span class='id identifier rubyid_upload_from_stream'>upload_from_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_open_upload_stream'>open_upload_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_stream'>stream</span><span class='op'>|</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_stream'>stream</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_io'>io</span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>IOError</span>
      <span class='kw'>begin</span>
        <span class='id identifier rubyid_stream'>stream</span><span class='period'>.</span><span class='id identifier rubyid_abort'>abort</span>
      <span class='kw'>rescue</span> <span class='const'><span class='object_link'><a href="../Error.html" title="Mongo::Error (class)">Error</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Error/OperationFailure.html" title="Mongo::Error::OperationFailure (class)">OperationFailure</a></span></span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_raise'>raise</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_file_id'>file_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="write_concern-instance_method">
  
    #<strong>write_concern</strong>  &#x21d2; <tt><span class='object_link'><a href="../WriteConcern.html" title="Mongo::WriteConcern (module)">Mongo::WriteConcern</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the write concern.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Get the write concern.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_stream'>stream</span><span class='period'>.</span><span class='id identifier rubyid_write_concern'>write_concern</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../WriteConcern.html" title="Mongo::WriteConcern (module)">Mongo::WriteConcern</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The write concern.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


451
452
453
454
455
456
457</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/grid/fs_bucket.rb', line 451</span>

<span class='kw'>def</span> <span class='id identifier rubyid_write_concern'>write_concern</span>
  <span class='ivar'>@write_concern</span> <span class='op'>||=</span> <span class='kw'>if</span> <span class='id identifier rubyid_wco'>wco</span> <span class='op'>=</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:write_concern</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:write</span><span class='rbracket'>]</span>
    <span class='const'><span class='object_link'><a href="../WriteConcern.html" title="Mongo::WriteConcern (module)">WriteConcern</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../WriteConcern.html#get-instance_method" title="Mongo::WriteConcern#get (method)">get</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_wco'>wco</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_database'>database</span><span class='period'>.</span><span class='id identifier rubyid_write_concern'>write_concern</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Apr 16 01:16:54 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.24 (ruby-2.7.0).
</div>

    </div>
  </body>
</html>