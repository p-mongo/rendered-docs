<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Mongo::Cursor
  
    &mdash; mongo-2.14.0.beta
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Mongo::Cursor";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span></span>
     &raquo; 
    <span class="title">Cursor</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Mongo::Cursor
  
  
  <span class="private note title">Private</span>
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Mongo::Cursor</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  <dl>
      <dt>Extended by:</dt>
      <dd>Forwardable</dd>
  </dl>
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd>Enumerable, <span class='object_link'><a href="Retryable.html" title="Mongo::Retryable (module)">Retryable</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/mongo/cursor.rb<span class="defines">,<br />
  lib/mongo/cursor/builder/op_get_more.rb,<br /> lib/mongo/cursor/builder/op_kill_cursors.rb,<br /> lib/mongo/cursor/builder/get_more_command.rb,<br /> lib/mongo/cursor/builder/kill_cursors_command.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This class is part of a private API.</strong>
  You should avoid using this class if possible, as it may be removed or be changed in the future.
</p>

<p>Client-side representation of an iterator over a query result set on the server.</p>

<p><code>Cursor</code> objects are not directly exposed to application code. Rather, <code>Collection::View</code> exposes the <code>Enumerable</code> interface to the applications, and the enumerator is backed by a <code>Cursor</code> instance.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Get an array of 5 users named Emily.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Emily</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_limit'>limit</span><span class='lparen'>(</span><span class='int'>5</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span></code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>Call a block on each user doc.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_doc'>doc</span> <span class='rbrace'>}</span></code></pre>
    
  </div>


</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="CachingCursor.html" title="Mongo::CachingCursor (class)">CachingCursor</a></span></p>
</div>
<h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Cursor/Builder.html" title="Mongo::Cursor::Builder (module)">Builder</a></span>
    
  
    
  
</p>




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#resume_token-instance_method" title="#resume_token (instance method)">#<strong>resume_token</strong>  &#x21d2; BSON::Document | nil </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>The resume token tracked by the cursor for change stream resuming.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#server-instance_method" title="#server (instance method)">#<strong>server</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#view-instance_method" title="#view (instance method)">#<strong>view</strong>  &#x21d2; Collection::View </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>View The collection view.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#finalize-class_method" title="finalize (class method)">.<strong>finalize</strong>(cursor_id, cluster, op_spec, server, session)  &#x21d2; Proc </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Finalize the cursor for garbage collection.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#batch_size-instance_method" title="#batch_size (instance method)">#<strong>batch_size</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Get the batch size.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#close-instance_method" title="#close (instance method)">#<strong>close</strong>  &#x21d2; nil </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Closes this cursor, freeing any associated resources on the client and the server.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#closed%3F-instance_method" title="#closed? (instance method)">#<strong>closed?</strong>  &#x21d2; true, false </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Is the cursor closed?.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#collection_name-instance_method" title="#collection_name (instance method)">#<strong>collection_name</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Get the parsed collection name.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each-instance_method" title="#each (instance method)">#<strong>each</strong>  &#x21d2; Enumerator </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Iterate through documents returned from the query.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_more-instance_method" title="#get_more (instance method)">#<strong>get_more</strong>  &#x21d2; Array&lt;BSON::Document&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Execute a getMore command and return the batch of documents obtained from the server.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#id-instance_method" title="#id (instance method)">#<strong>id</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Get the cursor id.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(view, result, server, options = {})  &#x21d2; Cursor </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a <code>Cursor</code> object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Get a human-readable string representation of <code>Cursor</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_return-instance_method" title="#to_return (instance method)">#<strong>to_return</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Get the number of documents to return.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#try_next-instance_method" title="#try_next (instance method)">#<strong>try_next</strong>  &#x21d2; BSON::Document | nil </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Return one document from the query, if one is available.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Retryable.html" title="Mongo::Retryable (module)">Retryable</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Retryable.html#legacy_write_with_retry-instance_method" title="Mongo::Retryable#legacy_write_with_retry (method)">#legacy_write_with_retry</a></span>, <span class='object_link'><a href="Retryable.html#nro_write_with_retry-instance_method" title="Mongo::Retryable#nro_write_with_retry (method)">#nro_write_with_retry</a></span>, <span class='object_link'><a href="Retryable.html#read_with_one_retry-instance_method" title="Mongo::Retryable#read_with_one_retry (method)">#read_with_one_retry</a></span>, <span class='object_link'><a href="Retryable.html#read_with_retry-instance_method" title="Mongo::Retryable#read_with_retry (method)">#read_with_retry</a></span>, <span class='object_link'><a href="Retryable.html#read_with_retry_cursor-instance_method" title="Mongo::Retryable#read_with_retry_cursor (method)">#read_with_retry_cursor</a></span>, <span class='object_link'><a href="Retryable.html#write_with_retry-instance_method" title="Mongo::Retryable#write_with_retry (method)">#write_with_retry</a></span></p>

  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(view, result, server, options = {})  &#x21d2; <tt><span class='object_link'><a href="" title="Mongo::Cursor (class)">Cursor</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Creates a <code>Cursor</code> object.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Instantiate the cursor.</p>
</div></p>
      
      <pre class="example code"><code><span class='const'><span class='object_link'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Mongo::Cursor (class)">Cursor</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_view'>view</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='comma'>,</span> <span class='id identifier rubyid_server'>server</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>view</span>
      
      
        <span class='type'>(<tt>CollectionView</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The <code>CollectionView</code> defining the query.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>result</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Operation/Result.html" title="Mongo::Operation::Result (class)">Operation::Result</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The result of the first execution.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>server</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Server.html" title="Mongo::Server (class)">Server</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The server this cursor is locked to.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The cursor options.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:disable_retry</span>
          <span class="type">(<tt>true</tt>, <tt>false</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Whether to disable retrying on error when sending getMore operations (deprecated, getMore operations are no longer retried)</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:retry_reads</span>
          <span class="type">(<tt>true</tt>, <tt>false</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Retry reads (following the modern mechanism), default is true</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 68</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_view'>view</span><span class='comma'>,</span> <span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='ivar'>@view</span> <span class='op'>=</span> <span class='id identifier rubyid_view'>view</span>
  <span class='ivar'>@server</span> <span class='op'>=</span> <span class='id identifier rubyid_server'>server</span>
  <span class='ivar'>@initial_result</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span>
  <span class='ivar'>@remaining</span> <span class='op'>=</span> <span class='id identifier rubyid_limit'>limit</span> <span class='kw'>if</span> <span class='id identifier rubyid_limited?'>limited?</span>
  <span class='ivar'>@cursor_id</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_cursor_id'>cursor_id</span>
  <span class='kw'>if</span> <span class='ivar'>@cursor_id</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Cursor id must be present in the result</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
  <span class='ivar'>@coll_name</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>
  <span class='ivar'>@session</span> <span class='op'>=</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:session</span><span class='rbracket'>]</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_closed?'>closed?</span>
    <span class='id identifier rubyid_register'>register</span>
    <span class='const'>ObjectSpace</span><span class='period'>.</span><span class='id identifier rubyid_define_finalizer'>define_finalizer</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_finalize'>finalize</span><span class='lparen'>(</span><span class='ivar'>@cursor_id</span><span class='comma'>,</span>
      <span class='id identifier rubyid_cluster'>cluster</span><span class='comma'>,</span>
      <span class='id identifier rubyid_kill_cursors_op_spec'>kill_cursors_op_spec</span><span class='comma'>,</span>
      <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span>
      <span class='ivar'>@session</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="resume_token-instance_method">
  
    #<strong>resume_token</strong>  &#x21d2; <tt>BSON::Document | nil</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>The resume token tracked by the cursor for change stream resuming</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>BSON::Document | nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The cursor resume token.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


49
50
51</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 49</span>

<span class='kw'>def</span> <span class='id identifier rubyid_resume_token'>resume_token</span>
  <span class='ivar'>@resume_token</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="server-instance_method">
  
    #<strong>server</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 91</span>

<span class='kw'>def</span> <span class='id identifier rubyid_server'>server</span>
  <span class='ivar'>@server</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="view-instance_method">
  
    #<strong>view</strong>  &#x21d2; <tt><span class='object_link'><a href="Collection/View.html" title="Mongo::Collection::View (class)">Collection::View</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Returns view The collection view.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Collection/View.html" title="Mongo::Collection::View (class)">Collection::View</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>view The collection view.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 43</span>

<span class='kw'>def</span> <span class='id identifier rubyid_view'>view</span>
  <span class='ivar'>@view</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="finalize-class_method">
  
    .<strong>finalize</strong>(cursor_id, cluster, op_spec, server, session)  &#x21d2; <tt>Proc</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Finalize the cursor for garbage collection. Schedules this cursor to be included in a killCursors operation executed by the Cluster&#39;s CursorReaper.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Finalize the cursor.</p>
</div></p>
      
      <pre class="example code"><code><span class='const'><span class='object_link'><a href="" title="Mongo::Cursor (class)">Cursor</a></span></span><span class='period'>.</span><span class='id identifier rubyid_finalize'>finalize</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_cluster'>cluster</span><span class='comma'>,</span> <span class='id identifier rubyid_op'>op</span><span class='comma'>,</span> <span class='id identifier rubyid_server'>server</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cursor_id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The cursor&#39;s id.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cluster</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Cluster.html" title="Mongo::Cluster (class)">Mongo::Cluster</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The cluster associated with this cursor and its server.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>op_spec</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The killCursors operation specification.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>server</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Server.html" title="Mongo::Server (class)">Mongo::Server</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The server to send the killCursors operation to.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The Finalizer.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.3.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109
110
111
112</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 107</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_finalize'>finalize</span><span class='lparen'>(</span><span class='id identifier rubyid_cursor_id'>cursor_id</span><span class='comma'>,</span> <span class='id identifier rubyid_cluster'>cluster</span><span class='comma'>,</span> <span class='id identifier rubyid_op_spec'>op_spec</span><span class='comma'>,</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_proc'>proc</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_cluster'>cluster</span><span class='period'>.</span><span class='id identifier rubyid_schedule_kill_cursor'>schedule_kill_cursor</span><span class='lparen'>(</span><span class='id identifier rubyid_cursor_id'>cursor_id</span><span class='comma'>,</span> <span class='id identifier rubyid_op_spec'>op_spec</span><span class='comma'>,</span> <span class='id identifier rubyid_server'>server</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_session'>session</span><span class='period'>.</span><span class='id identifier rubyid_end_session'>end_session</span> <span class='kw'>if</span> <span class='id identifier rubyid_session'>session</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_session'>session</span><span class='period'>.</span><span class='id identifier rubyid_implicit?'>implicit?</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="batch_size-instance_method">
  
    #<strong>batch_size</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Get the batch size.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Get the batch size.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_cursor'>cursor</span><span class='period'>.</span><span class='id identifier rubyid_batch_size'>batch_size</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The batch size.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.2.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


245
246
247</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 245</span>

<span class='kw'>def</span> <span class='id identifier rubyid_batch_size'>batch_size</span>
  <span class='ivar'>@view</span><span class='period'>.</span><span class='id identifier rubyid_batch_size'>batch_size</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@view</span><span class='period'>.</span><span class='id identifier rubyid_batch_size'>batch_size</span> <span class='op'>&gt;</span> <span class='int'>0</span> <span class='op'>?</span> <span class='ivar'>@view</span><span class='period'>.</span><span class='id identifier rubyid_batch_size'>batch_size</span> <span class='op'>:</span> <span class='id identifier rubyid_limit'>limit</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="close-instance_method">
  
    #<strong>close</strong>  &#x21d2; <tt>nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Closes this cursor, freeing any associated resources on the client and the server.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Always nil.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Error/OperationFailure.html" title="Mongo::Error::OperationFailure (class)">Error::OperationFailure</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the server cursor close fails.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


268
269
270
271
272
273
274
275
276
277
278
279
280</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 268</span>

<span class='kw'>def</span> <span class='id identifier rubyid_close'>close</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_closed?'>closed?</span>

  <span class='id identifier rubyid_unregister'>unregister</span>
  <span class='id identifier rubyid_read_with_one_retry'>read_with_one_retry</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_kill_cursors_operation'>kill_cursors_operation</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='ivar'>@server</span><span class='comma'>,</span> <span class='label'>client:</span> <span class='id identifier rubyid_client'>client</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>nil</span>
<span class='kw'>ensure</span>
  <span class='id identifier rubyid_end_session'>end_session</span>
  <span class='ivar'>@cursor_id</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="closed?-instance_method">
  
    #<strong>closed?</strong>  &#x21d2; <tt>true</tt>, <tt>false</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Is the cursor closed?</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Is the cursor closed?</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_cursor'>cursor</span><span class='period'>.</span><span class='id identifier rubyid_closed?'>closed?</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the cursor is closed.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.2.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


257
258
259
260</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 257</span>

<span class='kw'>def</span> <span class='id identifier rubyid_closed?'>closed?</span>
  <span class='comment'># @cursor_id should in principle never be nil
</span>  <span class='ivar'>@cursor_id</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='ivar'>@cursor_id</span> <span class='op'>==</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="collection_name-instance_method">
  
    #<strong>collection_name</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Get the parsed collection name.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Get the parsed collection name.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_cursor'>cursor</span><span class='period'>.</span><span class='id identifier rubyid_coll_name'>coll_name</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The collection name.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.2.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


290
291
292</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 290</span>

<span class='kw'>def</span> <span class='id identifier rubyid_collection_name'>collection_name</span>
  <span class='ivar'>@coll_name</span> <span class='op'>||</span> <span class='id identifier rubyid_collection'>collection</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each-instance_method">
  
    #<strong>each</strong>  &#x21d2; <tt>Enumerator</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Iterate through documents returned from the query.</p>

<p>A cursor may be iterated at most once. Incomplete iteration is also allowed. Attempting to iterate the cursor more than once raises InvalidCursorOperation.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Iterate over the documents in the cursor.</p>
</div></p>
      
      <pre class="example code"><code>cursor.each do |doc|
  ...
end</code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Enumerator</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The enumerator.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 140</span>

<span class='kw'>def</span> <span class='id identifier rubyid_each'>each</span>

  <span class='comment'># If we already iterated past the first batch (i.e., called get_more
</span>  <span class='comment'># at least once), the cursor on the server side has advanced past
</span>  <span class='comment'># the first batch and restarting iteration from the beginning by
</span>  <span class='comment'># returning initial result would miss documents in the second batch
</span>  <span class='comment'># and subsequent batches up to wherever the cursor is. Detect this
</span>  <span class='comment'># condition and abort the iteration.
</span>  <span class='comment'>#
</span>  <span class='comment'># In a future driver version, each would either continue from the
</span>  <span class='comment'># end of previous iteration or would always restart from the
</span>  <span class='comment'># beginning.
</span>  <span class='kw'>if</span> <span class='ivar'>@get_more_called</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="Error.html" title="Mongo::Error (class)">Error</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Error/InvalidCursorOperation.html" title="Mongo::Error::InvalidCursorOperation (class)">InvalidCursorOperation</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Cannot restart iteration of a cursor which issued a getMore</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='comment'># To maintain compatibility with pre-2.10 driver versions, reset
</span>  <span class='comment'># the documents array each time a new iteration is started.
</span>  <span class='ivar'>@documents</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='comment'># StopIteration raised by try_next ends this loop.
</span>    <span class='id identifier rubyid_loop'>loop</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_document'>document</span> <span class='op'>=</span> <span class='id identifier rubyid_try_next'>try_next</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_document'>document</span> <span class='kw'>if</span> <span class='id identifier rubyid_document'>document</span>
    <span class='kw'>end</span>
    <span class='kw'>self</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_documents'>documents</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='comment'># StopIteration raised by try_next ends this loop.
</span>    <span class='id identifier rubyid_loop'>loop</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_document'>document</span> <span class='op'>=</span> <span class='id identifier rubyid_try_next'>try_next</span>
      <span class='id identifier rubyid_documents'>documents</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_document'>document</span> <span class='kw'>if</span> <span class='id identifier rubyid_document'>document</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_documents'>documents</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_more-instance_method">
  
    #<strong>get_more</strong>  &#x21d2; <tt>Array&lt;BSON::Document&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Execute a getMore command and return the batch of documents obtained from the server.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;BSON::Document&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The batch of documents</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


327
328
329
330
331
332
333
334
335
336</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 327</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_more'>get_more</span>
  <span class='ivar'>@get_more_called</span> <span class='op'>=</span> <span class='kw'>true</span>

  <span class='comment'># Modern retryable reads specification prohibits retrying getMores.
</span>  <span class='comment'># Legacy retryable read logic used to retry getMores, but since
</span>  <span class='comment'># doing so may result in silent data loss, the driver no longer retries
</span>  <span class='comment'># getMore operations in any circumstance.
</span>  <span class='comment'># https://github.com/mongodb/specifications/blob/master/source/retryable-reads/retryable-reads.rst#qa
</span>  <span class='id identifier rubyid_process'>process</span><span class='lparen'>(</span><span class='id identifier rubyid_get_more_operation'>get_more_operation</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='ivar'>@server</span><span class='comma'>,</span> <span class='label'>client:</span> <span class='id identifier rubyid_client'>client</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="id-instance_method">
  
    #<strong>id</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>A cursor id of 0 means the cursor was closed on the server.</p>
</div>
  </div>


<p>Get the cursor id.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Get the cursor id.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_cursor'>cursor</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The cursor id.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.2.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


304
305
306</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 304</span>

<span class='kw'>def</span> <span class='id identifier rubyid_id'>id</span>
  <span class='ivar'>@cursor_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inspect-instance_method">
  
    #<strong>inspect</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Get a human-readable string representation of <code>Cursor</code>.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Inspect the cursor.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_cursor'>cursor</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A string representation of a <code>Cursor</code> instance.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


122
123
124</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 122</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;Mongo::Cursor:0x</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_object_id'>object_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> @view=</span><span class='embexpr_beg'>#{</span><span class='ivar'>@view</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_return-instance_method">
  
    #<strong>to_return</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Get the number of documents to return. Used on 3.0 and lower server versions.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Get the number to return.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_cursor'>cursor</span><span class='period'>.</span><span class='id identifier rubyid_to_return'>to_return</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of documents to return.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.2.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


317
318
319</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 317</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_return'>to_return</span>
  <span class='id identifier rubyid_use_limit?'>use_limit?</span> <span class='op'>?</span> <span class='ivar'>@remaining</span> <span class='op'>:</span> <span class='lparen'>(</span><span class='id identifier rubyid_batch_size'>batch_size</span> <span class='op'>||</span> <span class='int'>0</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="try_next-instance_method">
  
    #<strong>try_next</strong>  &#x21d2; <tt>BSON::Document | nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This method is experimental and subject to change.</p>
</div>
  </div>


<p>Return one document from the query, if one is available.</p>

<p>This method will wait up to max_await_time_ms milliseconds for changes from the server, and if no changes are received it will return nil. If there are no more documents to return from the server, or if we have exhausted the cursor, it will raise a StopIteration exception.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>BSON::Document | nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A document.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>StopIteration</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Raised on the calls after the cursor had been completely iterated.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/cursor.rb', line 194</span>

<span class='kw'>def</span> <span class='id identifier rubyid_try_next'>try_next</span>
  <span class='kw'>if</span> <span class='ivar'>@documents</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='comment'># Since published versions of Mongoid have a copy of old driver cursor
</span>    <span class='comment'># code, our dup call in #process isn&#39;t invoked when Mongoid query
</span>    <span class='comment'># cache is active. Work around that by also calling dup here on
</span>    <span class='comment'># the result of #process which might come out of Mongoid&#39;s code.
</span>    <span class='ivar'>@documents</span> <span class='op'>=</span> <span class='id identifier rubyid_process'>process</span><span class='lparen'>(</span><span class='ivar'>@initial_result</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
    <span class='comment'># the documents here can be an empty array, hence
</span>    <span class='comment'># we may end up issuing a getMore in the first try_next call
</span>  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='ivar'>@documents</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='comment'># On empty batches, we cache the batch resume token
</span>    <span class='id identifier rubyid_cache_batch_resume_token'>cache_batch_resume_token</span>

    <span class='kw'>unless</span> <span class='id identifier rubyid_closed?'>closed?</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_exhausted?'>exhausted?</span>
        <span class='id identifier rubyid_close'>close</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>StopIteration</span>
      <span class='kw'>end</span>
      <span class='ivar'>@documents</span> <span class='op'>=</span> <span class='id identifier rubyid_get_more'>get_more</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>StopIteration</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='comment'># cursor is closed here
</span>    <span class='comment'># keep documents as an empty array
</span>  <span class='kw'>end</span>

  <span class='comment'># If there is at least one document, cache its _id
</span>  <span class='kw'>if</span> <span class='ivar'>@documents</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_cache_resume_token'>cache_resume_token</span><span class='lparen'>(</span><span class='ivar'>@documents</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Cache the batch resume token if we are iterating
</span>  <span class='comment'># over the last document, or if the batch is empty
</span>  <span class='kw'>if</span> <span class='ivar'>@documents</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&lt;=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_cache_batch_resume_token'>cache_batch_resume_token</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='ivar'>@documents</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Oct  7 18:23:26 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.25 (ruby-2.7.1).
</div>

    </div>
  </body>
</html>