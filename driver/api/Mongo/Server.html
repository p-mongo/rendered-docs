<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Mongo::Server
  
    &mdash; mongo-2.14.0.beta
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Mongo::Server";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span></span>
     &raquo; 
    <span class="title">Server</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Mongo::Server
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Mongo::Server</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  <dl>
      <dt>Extended by:</dt>
      <dd>Forwardable</dd>
  </dl>
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="Event/Publisher.html" title="Mongo::Event::Publisher (module)">Event::Publisher</a></span>, <span class='object_link'><a href="Monitoring/Publishable.html" title="Mongo::Monitoring::Publishable (module)">Monitoring::Publishable</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/mongo/server.rb<span class="defines">,<br />
  lib/mongo/server/context.rb,<br /> lib/mongo/server/monitor.rb,<br /> lib/mongo/server/connection.rb,<br /> lib/mongo/server/description.rb,<br /> lib/mongo/server/app_metadata.rb,<br /> lib/mongo/server/push_monitor.rb,<br /> lib/mongo/server/connection_base.rb,<br /> lib/mongo/server/connection_pool.rb,<br /> lib/mongo/server/connection_common.rb,<br /> lib/mongo/server/monitor/connection.rb,<br /> lib/mongo/server/pending_connection.rb,<br /> lib/mongo/server/description/features.rb,<br /> lib/mongo/server/monitor/app_metadata.rb,<br /> lib/mongo/server/push_monitor/connection.rb,<br /> lib/mongo/server/round_trip_time_averager.rb,<br /> lib/mongo/server/connection_pool/populator.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Represents a single server on the server side that can be standalone, part of a replica set, or a mongos.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Server/AppMetadata.html" title="Mongo::Server::AppMetadata (class)">AppMetadata</a></span>, <span class='object_link'><a href="Server/Connection.html" title="Mongo::Server::Connection (class)">Connection</a></span>, <span class='object_link'><a href="Server/ConnectionBase.html" title="Mongo::Server::ConnectionBase (class)">ConnectionBase</a></span>, <span class='object_link'><a href="Server/ConnectionCommon.html" title="Mongo::Server::ConnectionCommon (class)">ConnectionCommon</a></span>, <span class='object_link'><a href="Server/ConnectionPool.html" title="Mongo::Server::ConnectionPool (class)">ConnectionPool</a></span>, <span class='object_link'><a href="Server/Context.html" title="Mongo::Server::Context (class)">Context</a></span>, <span class='object_link'><a href="Server/Description.html" title="Mongo::Server::Description (class)">Description</a></span>, <span class='object_link'><a href="Server/Monitor.html" title="Mongo::Server::Monitor (class)">Monitor</a></span>, <span class='object_link'><a href="Server/PendingConnection.html" title="Mongo::Server::PendingConnection (class)">PendingConnection</a></span>, <span class='object_link'><a href="Server/Populator.html" title="Mongo::Server::Populator (class)">Populator</a></span>, <span class='object_link'><a href="Server/PushMonitor.html" title="Mongo::Server::PushMonitor (class)">PushMonitor</a></span>, <span class='object_link'><a href="Server/RoundTripTimeAverager.html" title="Mongo::Server::RoundTripTimeAverager (class)">RoundTripTimeAverager</a></span>
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="CONNECT_TIMEOUT-constant" class="">CONNECT_TIMEOUT =
          <div class="docstring">
  <div class="discussion">
    
<p>The default time in seconds to timeout a connection attempt.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.4.3</p>
</div>
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='int'>10</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
    </dl>
  



  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="Loggable.html" title="Mongo::Loggable (module)">Loggable</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Loggable.html#PREFIX-constant" title="Mongo::Loggable::PREFIX (constant)">Loggable::PREFIX</a></span></p>


  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#address-instance_method" title="#address (instance method)">#<strong>address</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The configured address for the server.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#cluster-instance_method" title="#cluster (instance method)">#<strong>cluster</strong>  &#x21d2; Cluster </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Cluster The server cluster.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#description-instance_method" title="#description (instance method)">#<strong>description</strong>  &#x21d2; Server::Description </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Description The server description the monitor refreshes.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#monitor-instance_method" title="#monitor (instance method)">#<strong>monitor</strong>  &#x21d2; nil | Monitor </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Monitor The server monitor.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#monitoring-instance_method" title="#monitoring (instance method)">#<strong>monitoring</strong>  &#x21d2; Monitoring </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Monitoring The monitoring.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#options-instance_method" title="#options (instance method)">#<strong>options</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The options hash.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#round_trip_time_averager-instance_method" title="#round_trip_time_averager (instance method)">#<strong>round_trip_time_averager</strong>  &#x21d2; RoundTripTimeAverager </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Round trip time averager object.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#scan_semaphore-instance_method" title="#scan_semaphore (instance method)">#<strong>scan_semaphore</strong>  &#x21d2; Semaphore </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Semaphore to signal to request an immediate scan of this server by its monitor, if one is running.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="Event/Publisher.html" title="Mongo::Event::Publisher (module)">Event::Publisher</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Event/Publisher.html#event_listeners-instance_method" title="Mongo::Event::Publisher#event_listeners (method)">#event_listeners</a></span></p>


  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#finalize-class_method" title="finalize (class method)">.<strong>finalize</strong>(monitor)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>When the server is flagged for garbage collection, stop the monitor thread.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#==-instance_method" title="#== (instance method)">#<strong>==</strong>(other)  &#x21d2; true, false </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Is this server equal to another?.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clear_connection_pool-instance_method" title="#clear_connection_pool (instance method)">#<strong>clear_connection_pool</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public deprecated">
  <span class="summary_signature">
    
      <a href="#compressor-instance_method" title="#compressor (instance method)">#<strong>compressor</strong>  &#x21d2; String | nil </a>
    

    
  </span>
  
  
  
  
  
  <span class="deprecated note title">deprecated</span>
  

  
    <span class="summary_desc"><strong>Deprecated.</strong> <div class='inline'></div></span>
  
</li>

      
        <li class="public deprecated">
  <span class="summary_signature">
    
      <a href="#connectable%3F-instance_method" title="#connectable? (instance method)">#<strong>connectable?</strong>  &#x21d2; true, false </a>
    

    
  </span>
  
  
  
  
  
  <span class="deprecated note title">deprecated</span>
  

  
    <span class="summary_desc"><strong>Deprecated.</strong> <div class='inline'>
<p>No longer necessary with Server Selection specification.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connected%3F-instance_method" title="#connected? (instance method)">#<strong>connected?</strong>  &#x21d2; true|false </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Whether the server is connected.</p>
</div></span>
  
</li>

      
        <li class="public deprecated">
  <span class="summary_signature">
    
      <a href="#context-instance_method" title="#context (instance method)">#<strong>context</strong>  &#x21d2; Mongo::Server::Context </a>
    

    
  </span>
  
  
  
  
  
  <span class="deprecated note title">deprecated</span>
  

  
    <span class="summary_desc"><strong>Deprecated.</strong> <div class='inline'>
<p>Will be removed in version 3.0</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#disconnect!-instance_method" title="#disconnect! (instance method)">#<strong>disconnect!</strong>  &#x21d2; true </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Disconnect the driver from this server.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handle_auth_failure!-instance_method" title="#handle_auth_failure! (instance method)">#<strong>handle_auth_failure!</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handle authentication failure.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handle_handshake_failure!-instance_method" title="#handle_handshake_failure! (instance method)">#<strong>handle_handshake_failure!</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Handle handshake failure.</p>
</div></span>
  
</li>

      
        <li class="public deprecated">
  <span class="summary_signature">
    
      <a href="#heartbeat_frequency-instance_method" title="#heartbeat_frequency (instance method)">#<strong>heartbeat_frequency</strong>  &#x21d2; Object </a>
    

    
      (also: #heartbeat_frequency_seconds)
    
  </span>
  
  
  
  
  
  <span class="deprecated note title">deprecated</span>
  

  
    <span class="summary_desc"><strong>Deprecated.</strong> <div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(address, cluster, monitoring, event_listeners, options = {})  &#x21d2; Server </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Instantiate a new server object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get a pretty printed server inspection.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#last_scan-instance_method" title="#last_scan (instance method)">#<strong>last_scan</strong>  &#x21d2; Time | nil </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Last_scan The time when the last server scan completed, or nil if the server has not been scanned yet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#matches_tag_set%3F-instance_method" title="#matches_tag_set? (instance method)">#<strong>matches_tag_set?</strong>(tag_set)  &#x21d2; true, false </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Determine if the provided tags are a subset of the server&#39;s tags.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#next_connection_id-instance_method" title="#next_connection_id (instance method)">#<strong>next_connection_id</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pool-instance_method" title="#pool (instance method)">#<strong>pool</strong>  &#x21d2; Mongo::Server::ConnectionPool </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the connection pool for this server.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reconnect!-instance_method" title="#reconnect! (instance method)">#<strong>reconnect!</strong>  &#x21d2; true </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Restart the server monitor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#retry_reads%3F-instance_method" title="#retry_reads? (instance method)">#<strong>retry_reads?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Whether the server supports modern read retries.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#retry_writes%3F-instance_method" title="#retry_writes? (instance method)">#<strong>retry_writes?</strong>  &#x21d2; true, false </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Will writes sent to this server be retried.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start_monitoring-instance_method" title="#start_monitoring (instance method)">#<strong>start_monitoring</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Start monitoring the server.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#status-instance_method" title="#status (instance method)">#<strong>status</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>String representing server status (e.g. PRIMARY).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#summary-instance_method" title="#summary (instance method)">#<strong>summary</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unknown!-instance_method" title="#unknown! (instance method)">#<strong>unknown!</strong>(options = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Marks server unknown and publishes the associated SDAM event (server description changed).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_description-instance_method" title="#update_description (instance method)">#<strong>update_description</strong>(description)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_last_scan-instance_method" title="#update_last_scan (instance method)">#<strong>update_last_scan</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#with_connection-instance_method" title="#with_connection (instance method)">#<strong>with_connection</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Execute a block of code with a connection, that is checked out of the server&#39;s pool and then checked back in.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Event/Publisher.html" title="Mongo::Event::Publisher (module)">Event::Publisher</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Event/Publisher.html#publish-instance_method" title="Mongo::Event::Publisher#publish (method)">#publish</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Monitoring/Publishable.html" title="Mongo::Monitoring::Publishable (module)">Monitoring::Publishable</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Monitoring/Publishable.html#publish_cmap_event-instance_method" title="Mongo::Monitoring::Publishable#publish_cmap_event (method)">#publish_cmap_event</a></span>, <span class='object_link'><a href="Monitoring/Publishable.html#publish_event-instance_method" title="Mongo::Monitoring::Publishable#publish_event (method)">#publish_event</a></span>, <span class='object_link'><a href="Monitoring/Publishable.html#publish_sdam_event-instance_method" title="Mongo::Monitoring::Publishable#publish_sdam_event (method)">#publish_sdam_event</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Loggable.html" title="Mongo::Loggable (module)">Loggable</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Loggable.html#log_debug-instance_method" title="Mongo::Loggable#log_debug (method)">#log_debug</a></span>, <span class='object_link'><a href="Loggable.html#log_error-instance_method" title="Mongo::Loggable#log_error (method)">#log_error</a></span>, <span class='object_link'><a href="Loggable.html#log_fatal-instance_method" title="Mongo::Loggable#log_fatal (method)">#log_fatal</a></span>, <span class='object_link'><a href="Loggable.html#log_info-instance_method" title="Mongo::Loggable#log_info (method)">#log_info</a></span>, <span class='object_link'><a href="Loggable.html#log_warn-instance_method" title="Mongo::Loggable#log_warn (method)">#log_warn</a></span>, <span class='object_link'><a href="Loggable.html#logger-instance_method" title="Mongo::Loggable#logger (method)">#logger</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(address, cluster, monitoring, event_listeners, options = {})  &#x21d2; <tt><span class='object_link'><a href="" title="Mongo::Server (class)">Server</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Server must never be directly instantiated outside of a Cluster.</p>
</div>
  </div>


<p>Instantiate a new server object. Will start the background refresh and subscribe to the appropriate events.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Initialize the server.</p>
</div></p>
      
      <pre class="example code"><code><span class='const'><span class='object_link'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Mongo::Server (class)">Server</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>127.0.0.1:27017</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_cluster'>cluster</span><span class='comma'>,</span> <span class='id identifier rubyid_monitoring'>monitoring</span><span class='comma'>,</span> <span class='id identifier rubyid_listeners'>listeners</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>address</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Address.html" title="Mongo::Address (class)">Address</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The host:port address to connect to.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cluster</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Cluster.html" title="Mongo::Cluster (class)">Cluster</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The cluster the server belongs to.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>monitoring</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Monitoring.html" title="Mongo::Monitoring (class)">Monitoring</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The monitoring.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>event_listeners</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Event/Listeners.html" title="Mongo::Event::Listeners (class)">Event::Listeners</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The event listeners.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The server options.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:monitor</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>For internal driver use only: whether to monitor the server after instantiating it.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:monitoring_io</span>
          <span class="type">(<tt>true</tt>, <tt>false</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>For internal driver use only. Set to false to prevent SDAM-related I/O from being done by this server. Note: setting this option to false will make the server non-functional. It is intended for use in tests which manually invoke SDAM state transitions.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 56</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='id identifier rubyid_cluster'>cluster</span><span class='comma'>,</span> <span class='id identifier rubyid_monitoring'>monitoring</span><span class='comma'>,</span> <span class='id identifier rubyid_event_listeners'>event_listeners</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='ivar'>@address</span> <span class='op'>=</span> <span class='id identifier rubyid_address'>address</span>
  <span class='ivar'>@cluster</span> <span class='op'>=</span> <span class='id identifier rubyid_cluster'>cluster</span>
  <span class='ivar'>@monitoring</span> <span class='op'>=</span> <span class='id identifier rubyid_monitoring'>monitoring</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='id identifier rubyid__monitor'>_monitor</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:monitor</span><span class='rparen'>)</span>
  <span class='ivar'>@options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='ivar'>@event_listeners</span> <span class='op'>=</span> <span class='id identifier rubyid_event_listeners'>event_listeners</span>
  <span class='ivar'>@connection_id_gen</span> <span class='op'>=</span> <span class='const'>Class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="Id.html" title="Mongo::Id (module)">Id</a></span></span>
  <span class='kw'>end</span>
  <span class='ivar'>@scan_semaphore</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="DistinguishingSemaphore.html" title="Mongo::DistinguishingSemaphore (class)">DistinguishingSemaphore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="DistinguishingSemaphore.html#initialize-instance_method" title="Mongo::DistinguishingSemaphore#initialize (method)">new</a></span></span>
  <span class='ivar'>@round_trip_time_averager</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Server/RoundTripTimeAverager.html" title="Mongo::Server::RoundTripTimeAverager (class)">RoundTripTimeAverager</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Server/RoundTripTimeAverager.html#initialize-instance_method" title="Mongo::Server::RoundTripTimeAverager#initialize (method)">new</a></span></span>
  <span class='ivar'>@description</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Server/Description.html" title="Mongo::Server::Description (class)">Description</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Server/Description.html#initialize-instance_method" title="Mongo::Server::Description#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='ivar'>@last_scan</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:monitoring_io</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='kw'>false</span>
    <span class='ivar'>@monitor</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Server/Monitor.html" title="Mongo::Server::Monitor (class)">Monitor</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Server/Monitor.html#initialize-instance_method" title="Mongo::Server::Monitor#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_event_listeners'>event_listeners</span><span class='comma'>,</span> <span class='id identifier rubyid_monitoring'>monitoring</span><span class='comma'>,</span>
      <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span>
        <span class='label'>app_metadata:</span> <span class='const'><span class='object_link'><a href="Server/Monitor.html" title="Mongo::Server::Monitor (class)">Monitor</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Server/Monitor/AppMetadata.html" title="Mongo::Server::Monitor::AppMetadata (class)">AppMetadata</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Server/Monitor/AppMetadata.html#initialize-instance_method" title="Mongo::Server::Monitor::AppMetadata#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_cluster'>cluster</span><span class='period'>.</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span><span class='comma'>,</span>
        <span class='label'>heartbeat_interval:</span> <span class='id identifier rubyid_cluster'>cluster</span><span class='period'>.</span><span class='id identifier rubyid_heartbeat_interval'>heartbeat_interval</span><span class='comma'>,</span>
    <span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid__monitor'>_monitor</span> <span class='op'>==</span> <span class='kw'>false</span>
      <span class='id identifier rubyid_start_monitoring'>start_monitoring</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='ivar'>@connected</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='ivar'>@pool_lock</span> <span class='op'>=</span> <span class='const'>Mutex</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="address-instance_method">
  
    #<strong>address</strong>  &#x21d2; <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The configured address for the server.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The configured address for the server.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_address'>address</span>
  <span class='ivar'>@address</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="cluster-instance_method">
  
    #<strong>cluster</strong>  &#x21d2; <tt><span class='object_link'><a href="Cluster.html" title="Mongo::Cluster (class)">Cluster</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns cluster The server cluster.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Cluster.html" title="Mongo::Cluster (class)">Cluster</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>cluster The server cluster.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


89
90
91</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 89</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cluster'>cluster</span>
  <span class='ivar'>@cluster</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="description-instance_method">
  
    #<strong>description</strong>  &#x21d2; <tt><span class='object_link'><a href="Server/Description.html" title="Mongo::Server::Description (class)">Server::Description</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns description The server description the monitor refreshes.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Server/Description.html" title="Mongo::Server::Description (class)">Server::Description</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>description The server description the monitor refreshes.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103
104
105</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 103</span>

<span class='kw'>def</span> <span class='id identifier rubyid_description'>description</span>
  <span class='ivar'>@description</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="monitor-instance_method">
  
    #<strong>monitor</strong>  &#x21d2; <tt>nil | <span class='object_link'><a href="Server/Monitor.html" title="Mongo::Server::Monitor (class)">Monitor</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns monitor The server monitor. nil if the servenr was created with monitoring_io: false option.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil | <span class='object_link'><a href="Server/Monitor.html" title="Mongo::Server::Monitor (class)">Monitor</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>monitor The server monitor. nil if the servenr was created with monitoring_io: false option.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


93
94
95</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 93</span>

<span class='kw'>def</span> <span class='id identifier rubyid_monitor'>monitor</span>
  <span class='ivar'>@monitor</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="monitoring-instance_method">
  
    #<strong>monitoring</strong>  &#x21d2; <tt><span class='object_link'><a href="Monitoring.html" title="Mongo::Monitoring (class)">Monitoring</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns monitoring The monitoring.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Monitoring.html" title="Mongo::Monitoring (class)">Monitoring</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>monitoring The monitoring.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


99
100
101</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 99</span>

<span class='kw'>def</span> <span class='id identifier rubyid_monitoring'>monitoring</span>
  <span class='ivar'>@monitoring</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="options-instance_method">
  
    #<strong>options</strong>  &#x21d2; <tt>Hash</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The options hash.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The options hash.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96
97
98</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 96</span>

<span class='kw'>def</span> <span class='id identifier rubyid_options'>options</span>
  <span class='ivar'>@options</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="round_trip_time_averager-instance_method">
  
    #<strong>round_trip_time_averager</strong>  &#x21d2; <tt><span class='object_link'><a href="Server/RoundTripTimeAverager.html" title="Mongo::Server::RoundTripTimeAverager (class)">RoundTripTimeAverager</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Returns Round trip time averager object.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Server/RoundTripTimeAverager.html" title="Mongo::Server::RoundTripTimeAverager (class)">RoundTripTimeAverager</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Round trip time averager object.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


186
187
188</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 186</span>

<span class='kw'>def</span> <span class='id identifier rubyid_round_trip_time_averager'>round_trip_time_averager</span>
  <span class='ivar'>@round_trip_time_averager</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="scan_semaphore-instance_method">
  
    #<strong>scan_semaphore</strong>  &#x21d2; <tt><span class='object_link'><a href="Semaphore.html" title="Mongo::Semaphore (class)">Semaphore</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Returns Semaphore to signal to request an immediate scan of this server by its monitor, if one is running.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Semaphore.html" title="Mongo::Semaphore (class)">Semaphore</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Semaphore to signal to request an immediate scan of this server by its monitor, if one is running.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


182
183
184</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 182</span>

<span class='kw'>def</span> <span class='id identifier rubyid_scan_semaphore'>scan_semaphore</span>
  <span class='ivar'>@scan_semaphore</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="finalize-class_method">
  
    .<strong>finalize</strong>(monitor)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>When the server is flagged for garbage collection, stop the monitor thread.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Finalize the object.</p>
</div></p>
      
      <pre class="example code"><code><span class='const'><span class='object_link'><a href="" title="Mongo::Server (class)">Server</a></span></span><span class='period'>.</span><span class='id identifier rubyid_finalize'>finalize</span><span class='lparen'>(</span><span class='id identifier rubyid_monitor'>monitor</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>monitor</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Server/Monitor.html" title="Mongo::Server::Monitor (class)">Server::Monitor</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The server monitor.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.2.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


284
285
286</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 284</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_finalize'>finalize</span><span class='lparen'>(</span><span class='id identifier rubyid_monitor'>monitor</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_proc'>proc</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_monitor'>monitor</span><span class='period'>.</span><span class='id identifier rubyid_stop!'>stop!</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="==-instance_method">
  
    #<strong>==</strong>(other)  &#x21d2; <tt>true</tt>, <tt>false</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Is this server equal to another?</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Is the server equal to the other?</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_server'>server</span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The object to compare to.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the servers are equal.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


198
199
200
201</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 198</span>

<span class='kw'>def</span> <span class='op'>==</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="" title="Mongo::Server (class)">Server</a></span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_address'>address</span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_address'>address</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="clear_connection_pool-instance_method">
  
    #<strong>clear_connection_pool</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


545
546
547
548
549
550
551</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 545</span>

<span class='kw'>def</span> <span class='id identifier rubyid_clear_connection_pool'>clear_connection_pool</span>
  <span class='ivar'>@pool_lock</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='kw'>if</span> <span class='ivar'>@pool</span>
      <span class='ivar'>@pool</span><span class='period'>.</span><span class='id identifier rubyid_disconnect!'>disconnect!</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="compressor-instance_method">
  
    #<strong>compressor</strong>  &#x21d2; <tt>String | nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <div class="note deprecated"><strong>Deprecated.</strong> <div class='inline'></div></div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Compression is negotiated for each connection separately.</p>
</div>
  </div>


<p>The compressor negotiated by the server monitor, if any.</p>

<p>This attribute is nil if no server check has not yet completed, and if no compression was negatiated.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String | nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The negotiated compressor.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


140
141
142
143
144
145
146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 140</span>

<span class='kw'>def</span> <span class='id identifier rubyid_compressor'>compressor</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_monitor'>monitor</span>
    <span class='id identifier rubyid_monitor'>monitor</span><span class='period'>.</span><span class='id identifier rubyid_compressor'>compressor</span>
  <span class='kw'>else</span>
    <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="connectable?-instance_method">
  
    #<strong>connectable?</strong>  &#x21d2; <tt>true</tt>, <tt>false</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <div class="note deprecated"><strong>Deprecated.</strong> <div class='inline'>
<p>No longer necessary with Server Selection specification.</p>
</div></div>

<p>Determine if a connection to the server is able to be established and messages can be sent to it.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Is the server connectable?</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_connectable?'>connectable?</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the server is connectable.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


228</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 228</span>

<span class='kw'>def</span> <span class='id identifier rubyid_connectable?'>connectable?</span><span class='semicolon'>;</span> <span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="connected?-instance_method">
  
    #<strong>connected?</strong>  &#x21d2; <tt>true|false</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Whether the server is connected.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>true|false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Whether the server is connected.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.7.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


271
272
273</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 271</span>

<span class='kw'>def</span> <span class='id identifier rubyid_connected?'>connected?</span>
  <span class='ivar'>@connected</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="context-instance_method">
  
    #<strong>context</strong>  &#x21d2; <tt><span class='object_link'><a href="Server/Context.html" title="Mongo::Server::Context (class)">Mongo::Server::Context</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <div class="note deprecated"><strong>Deprecated.</strong> <div class='inline'>
<p>Will be removed in version 3.0</p>
</div></div>

<p>Get a new context for this server in which to send messages.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Get the server context.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_context'>context</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Server/Context.html" title="Mongo::Server::Context (class)">Mongo::Server::Context</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>context The server context.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


213
214
215</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 213</span>

<span class='kw'>def</span> <span class='id identifier rubyid_context'>context</span>
  <span class='const'><span class='object_link'><a href="Server/Context.html" title="Mongo::Server::Context (class)">Context</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Server/Context.html#initialize-instance_method" title="Mongo::Server::Context#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="disconnect!-instance_method">
  
    #<strong>disconnect!</strong>  &#x21d2; <tt>true</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Disconnect the driver from this server.</p>

<p>Disconnects all idle connections to this server in its connection pool, if any exist. Stops the populator of the connection pool, if it is running. Does not immediately close connections which are presently checked out (i.e. in use) - such connections will be closed when they are returned to their respective connection pools. Stop the server&#39;s background monitor.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Always true.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 242</span>

<span class='kw'>def</span> <span class='id identifier rubyid_disconnect!'>disconnect!</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_monitor'>monitor</span>
    <span class='id identifier rubyid_monitor'>monitor</span><span class='period'>.</span><span class='id identifier rubyid_stop!'>stop!</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid__pool'>_pool</span> <span class='op'>=</span> <span class='ivar'>@pool_lock</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='ivar'>@pool</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid__pool'>_pool</span>
    <span class='comment'># For backwards compatibility we disconnect/clear the pool rather
</span>    <span class='comment'># than close it here. We also stop the populator which allows the
</span>    <span class='comment'># the pool to continue providing connections but stops it from
</span>    <span class='comment'># connecting in background on clients/servers that are in fact
</span>    <span class='comment'># intended to be closed and no longer used.
</span>    <span class='kw'>begin</span>
      <span class='id identifier rubyid__pool'>_pool</span><span class='period'>.</span><span class='id identifier rubyid_disconnect!'>disconnect!</span><span class='lparen'>(</span><span class='label'>stop_populator:</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'><span class='object_link'><a href="Error.html" title="Mongo::Error (class)">Error</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Error/PoolClosedError.html" title="Mongo::Error::PoolClosedError (class)">PoolClosedError</a></span></span>
      <span class='comment'># If the pool was already closed, we don&#39;t need to do anything here.
</span>    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='ivar'>@connected</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="handle_auth_failure!-instance_method">
  
    #<strong>handle_auth_failure!</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Handle authentication failure.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Handle possible authentication failure.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_handle_auth_failure!'>handle_auth_failure!</span> <span class='kw'>do</span>
  <span class='const'><span class='object_link'><a href="Auth.html" title="Mongo::Auth (module)">Auth</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="Auth.html#get-instance_method" title="Mongo::Auth#get (method)">get</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_login'>login</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
<span class='kw'>end</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The result of the block execution.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Auth/Unauthorized.html" title="Mongo::Auth::Unauthorized (class)">Auth::Unauthorized</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the authentication failed.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.3.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


455
456
457
458
459
460
461
462
463
464
465
466
467
468</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 455</span>

<span class='kw'>def</span> <span class='id identifier rubyid_handle_auth_failure!'>handle_auth_failure!</span>
  <span class='kw'>yield</span>
<span class='kw'>rescue</span> <span class='const'><span class='object_link'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Error.html" title="Mongo::Error (class)">Error</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Error/SocketTimeoutError.html" title="Mongo::Error::SocketTimeoutError (class)">SocketTimeoutError</a></span></span>
  <span class='comment'># possibly cluster is slow, do not give up on it
</span>  <span class='id identifier rubyid_raise'>raise</span>
<span class='kw'>rescue</span> <span class='const'><span class='object_link'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Error.html" title="Mongo::Error (class)">Error</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Error/SocketError.html" title="Mongo::Error::SocketError (class)">SocketError</a></span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='comment'># non-timeout network error
</span>  <span class='id identifier rubyid_unknown!'>unknown!</span><span class='lparen'>(</span><span class='label'>generation:</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_generation'>generation</span><span class='comma'>,</span> <span class='label'>stop_push_monitor:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span>
<span class='kw'>rescue</span> <span class='const'><span class='object_link'><a href="Auth.html" title="Mongo::Auth (module)">Auth</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Auth/Unauthorized.html" title="Mongo::Auth::Unauthorized (class)">Unauthorized</a></span></span>
  <span class='comment'># auth error, keep server description and topology as they are
</span>  <span class='id identifier rubyid_pool'>pool</span><span class='period'>.</span><span class='id identifier rubyid_disconnect!'>disconnect!</span>
  <span class='id identifier rubyid_raise'>raise</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="handle_handshake_failure!-instance_method">
  
    #<strong>handle_handshake_failure!</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Handle handshake failure.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.7.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


436
437
438
439
440
441</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 436</span>

<span class='kw'>def</span> <span class='id identifier rubyid_handle_handshake_failure!'>handle_handshake_failure!</span>
  <span class='kw'>yield</span>
<span class='kw'>rescue</span> <span class='const'><span class='object_link'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Error.html" title="Mongo::Error (class)">Error</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Error/SocketError.html" title="Mongo::Error::SocketError (class)">SocketError</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Mongo.html" title="Mongo (module)">Mongo</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Error.html" title="Mongo::Error (class)">Error</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Error/SocketTimeoutError.html" title="Mongo::Error::SocketTimeoutError (class)">SocketTimeoutError</a></span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_unknown!'>unknown!</span><span class='lparen'>(</span><span class='label'>generation:</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_generation'>generation</span><span class='comma'>,</span> <span class='label'>stop_push_monitor:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="heartbeat_frequency-instance_method">
  
    #<strong>heartbeat_frequency</strong>  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='heartbeat_frequency_seconds-instance_method'>heartbeat_frequency_seconds</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <div class="note deprecated"><strong>Deprecated.</strong> <div class='inline'></div></div>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


118
119
120</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 118</span>

<span class='kw'>def</span> <span class='id identifier rubyid_heartbeat_frequency'>heartbeat_frequency</span>
  <span class='id identifier rubyid_cluster'>cluster</span><span class='period'>.</span><span class='id identifier rubyid_heartbeat_interval'>heartbeat_interval</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inspect-instance_method">
  
    #<strong>inspect</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get a pretty printed server inspection.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Get the server inspection.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The nice inspection string.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


313
314
315</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 313</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;Mongo::Server:0x</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_object_id'>object_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> address=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='period'>.</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="last_scan-instance_method">
  
    #<strong>last_scan</strong>  &#x21d2; <tt>Time | nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns last_scan The time when the last server scan completed, or nil if the server has not been scanned yet.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Time | nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>last_scan The time when the last server scan completed, or nil if the server has not been scanned yet.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.4.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


109
110
111
112
113
114
115</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 109</span>

<span class='kw'>def</span> <span class='id identifier rubyid_last_scan'>last_scan</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_description'>description</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_description'>description</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_description'>description</span><span class='period'>.</span><span class='id identifier rubyid_last_update_time'>last_update_time</span>
  <span class='kw'>else</span>
    <span class='ivar'>@last_scan</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="matches_tag_set?-instance_method">
  
    #<strong>matches_tag_set?</strong>(tag_set)  &#x21d2; <tt>true</tt>, <tt>false</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Determine if the provided tags are a subset of the server&#39;s tags.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Are the provided tags a subset of the server&#39;s tags.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_matches_tag_set?'>matches_tag_set?</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rack</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dc</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>nyc</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>tag_set</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The tag set to compare to the server&#39;s tags.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the provided tags are a subset of the server&#39;s tags.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


396
397
398
399
400</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 396</span>

<span class='kw'>def</span> <span class='id identifier rubyid_matches_tag_set?'>matches_tag_set?</span><span class='lparen'>(</span><span class='id identifier rubyid_tag_set'>tag_set</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tag_set'>tag_set</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_all?'>all?</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
    <span class='id identifier rubyid_tags'>tags</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_tags'>tags</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_tag_set'>tag_set</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="next_connection_id-instance_method">
  
    #<strong>next_connection_id</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


554
555
556</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 554</span>

<span class='kw'>def</span> <span class='id identifier rubyid_next_connection_id'>next_connection_id</span>
  <span class='ivar'>@connection_id_gen</span><span class='period'>.</span><span class='id identifier rubyid_next_id'>next_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="pool-instance_method">
  
    #<strong>pool</strong>  &#x21d2; <tt><span class='object_link'><a href="Server/ConnectionPool.html" title="Mongo::Server::ConnectionPool (class)">Mongo::Server::ConnectionPool</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the connection pool for this server.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Get the connection pool for the server.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_pool'>pool</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Server/ConnectionPool.html" title="Mongo::Server::ConnectionPool (class)">Mongo::Server::ConnectionPool</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The connection pool.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


380
381
382
383
384</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 380</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pool'>pool</span>
  <span class='ivar'>@pool_lock</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='ivar'>@pool</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="Server/ConnectionPool.html" title="Mongo::Server::ConnectionPool (class)">ConnectionPool</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Server/ConnectionPool.html#initialize-instance_method" title="Mongo::Server::ConnectionPool#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reconnect!-instance_method">
  
    #<strong>reconnect!</strong>  &#x21d2; <tt>true</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Restart the server monitor.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Restart the server monitor.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_reconnect!'>reconnect!</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Always true.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


410
411
412
413
414
415</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 410</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reconnect!'>reconnect!</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:monitoring_io</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_monitor'>monitor</span><span class='period'>.</span><span class='id identifier rubyid_restart!'>restart!</span>
  <span class='kw'>end</span>
  <span class='ivar'>@connected</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="retry_reads?-instance_method">
  
    #<strong>retry_reads?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Whether the server supports modern read retries.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


473
474
475</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 473</span>

<span class='kw'>def</span> <span class='id identifier rubyid_retry_reads?'>retry_reads?</span>
  <span class='op'>!</span><span class='op'>!</span><span class='lparen'>(</span><span class='id identifier rubyid_features'>features</span><span class='period'>.</span><span class='id identifier rubyid_sessions_enabled?'>sessions_enabled?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_logical_session_timeout'>logical_session_timeout</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="retry_writes?-instance_method">
  
    #<strong>retry_writes?</strong>  &#x21d2; <tt>true</tt>, <tt>false</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Retryable writes are only available on server versions 3.6+ and with sharded clusters or replica sets.</p>
</div>
  </div>


<p>Will writes sent to this server be retried.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Will writes be retried.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_retry_writes?'>retry_writes?</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If writes will be retried.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.5.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


488
489
490</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 488</span>

<span class='kw'>def</span> <span class='id identifier rubyid_retry_writes?'>retry_writes?</span>
  <span class='op'>!</span><span class='op'>!</span><span class='lparen'>(</span><span class='id identifier rubyid_features'>features</span><span class='period'>.</span><span class='id identifier rubyid_sessions_enabled?'>sessions_enabled?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_logical_session_timeout'>logical_session_timeout</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_standalone?'>standalone?</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="start_monitoring-instance_method">
  
    #<strong>start_monitoring</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Start monitoring the server.</p>

<p>Used internally by the driver to add a server to a cluster while delaying monitoring until the server is in the cluster.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


294
295
296
297
298
299
300
301
302
303</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 294</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start_monitoring'>start_monitoring</span>
  <span class='id identifier rubyid_publish_sdam_event'>publish_sdam_event</span><span class='lparen'>(</span>
    <span class='const'><span class='object_link'><a href="Monitoring.html" title="Mongo::Monitoring (class)">Monitoring</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Monitoring.html#SERVER_OPENING-constant" title="Mongo::Monitoring::SERVER_OPENING (constant)">SERVER_OPENING</a></span></span><span class='comma'>,</span>
    <span class='const'><span class='object_link'><a href="Monitoring.html" title="Mongo::Monitoring (class)">Monitoring</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Monitoring/Event.html" title="Mongo::Monitoring::Event (module)">Event</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Monitoring/Event/ServerOpening.html" title="Mongo::Monitoring::Event::ServerOpening (class)">ServerOpening</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Monitoring/Event/ServerOpening.html#initialize-instance_method" title="Mongo::Monitoring::Event::ServerOpening#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='id identifier rubyid_cluster'>cluster</span><span class='period'>.</span><span class='id identifier rubyid_topology'>topology</span><span class='rparen'>)</span>
  <span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:monitoring_io</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='kw'>false</span>
    <span class='const'>ObjectSpace</span><span class='period'>.</span><span class='id identifier rubyid_define_finalizer'>define_finalizer</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_finalize'>finalize</span><span class='lparen'>(</span><span class='id identifier rubyid_monitor'>monitor</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_monitor'>monitor</span><span class='period'>.</span><span class='id identifier rubyid_run!'>run!</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="status-instance_method">
  
    #<strong>status</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Returns String representing server status (e.g. PRIMARY).</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>String representing server status (e.g. PRIMARY).</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 320</span>

<span class='kw'>def</span> <span class='id identifier rubyid_status'>status</span>
  <span class='kw'>case</span>
  <span class='kw'>when</span> <span class='id identifier rubyid_primary?'>primary?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PRIMARY</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_secondary?'>secondary?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SECONDARY</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_standalone?'>standalone?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>STANDALONE</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_arbiter?'>arbiter?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ARBITER</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_ghost?'>ghost?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GHOST</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_other?'>other?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>OTHER</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_mongos?'>mongos?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MONGOS</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>when</span> <span class='id identifier rubyid_unknown?'>unknown?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>UNKNOWN</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='comment'># Since the summary method is often used for debugging, do not raise
</span>    <span class='comment'># an exception in case none of the expected types matched
</span>    <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="summary-instance_method">
  
    #<strong>summary</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This method is experimental and subject to change.</p>
</div>
  </div>



  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.7.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 349</span>

<span class='kw'>def</span> <span class='id identifier rubyid_summary'>summary</span>
  <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_replica_set_name'>replica_set_name</span>
    <span class='id identifier rubyid_status'>status</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> replica_set=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_replica_set_name'>replica_set_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_monitor'>monitor</span><span class='op'>&amp;.</span><span class='id identifier rubyid_running?'>running?</span>
    <span class='id identifier rubyid_status'>status</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> NO-MONITORING</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='ivar'>@pool</span>
    <span class='id identifier rubyid_status'>status</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> pool=</span><span class='embexpr_beg'>#{</span><span class='ivar'>@pool</span><span class='period'>.</span><span class='id identifier rubyid_summary'>summary</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_address_bit'>address_bit</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_address'>address</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='period'>.</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>nil</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;Server address=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address_bit'>address_bit</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unknown!-instance_method">
  
    #<strong>unknown!</strong>(options = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Marks server unknown and publishes the associated SDAM event (server description changed).</p>

<p>If the generation is passed in options, the server will only be marked unknown if the passed generation is no older than the current generation of the server&#39;s connection pool.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Options.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:generation</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Connection pool generation of the connection that was used for the operation that produced the error.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:keep_connection_pool</span>
          <span class="type">(<tt>true | false</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Usually when the new server description is unknown, the connection pool on the respective server is cleared. Set this option to true to keep the existing connection pool (required when handling not master errors on 4.2+ servers).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:topology_version</span>
          <span class="type">(<tt><span class='object_link'><a href="TopologyVersion.html" title="Mongo::TopologyVersion (class)">TopologyVersion</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Topology version of the error response that is causing the server to be marked unknown.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:stop_push_monitor</span>
          <span class="type">(<tt>true | false</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Whether to stop the PushMonitor associated with the server, if any.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.4.0, SDAM events are sent as of version 2.7.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 514</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unknown!'>unknown!</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:generation</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:generation</span><span class='rbracket'>]</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_pool'>pool</span><span class='period'>.</span><span class='id identifier rubyid_generation'>generation</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:topology_version</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_description'>description</span><span class='period'>.</span><span class='id identifier rubyid_topology_version'>topology_version</span> <span class='op'>&amp;&amp;</span>
    <span class='op'>!</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:topology_version</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_gt?'>gt?</span><span class='lparen'>(</span><span class='id identifier rubyid_description'>description</span><span class='period'>.</span><span class='id identifier rubyid_topology_version'>topology_version</span><span class='rparen'>)</span>
  <span class='kw'>then</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:stop_push_monitor</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_monitor'>monitor</span><span class='op'>&amp;.</span><span class='id identifier rubyid_stop_push_monitor!'>stop_push_monitor!</span>
  <span class='kw'>end</span>

  <span class='comment'># SDAM flow will update description on the server without in-place
</span>  <span class='comment'># mutations and invoke SDAM transitions as needed.
</span>  <span class='id identifier rubyid_config'>config</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:topology_version</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_config'>config</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>topologyVersion</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:topology_version</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_new_description'>new_description</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Server/Description.html" title="Mongo::Server::Description (class)">Description</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Server/Description.html#initialize-instance_method" title="Mongo::Server::Description#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='id identifier rubyid_config'>config</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cluster'>cluster</span><span class='period'>.</span><span class='id identifier rubyid_run_sdam_flow'>run_sdam_flow</span><span class='lparen'>(</span><span class='id identifier rubyid_description'>description</span><span class='comma'>,</span> <span class='id identifier rubyid_new_description'>new_description</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_description-instance_method">
  
    #<strong>update_description</strong>(description)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


540
541
542</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 540</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_description'>update_description</span><span class='lparen'>(</span><span class='id identifier rubyid_description'>description</span><span class='rparen'>)</span>
  <span class='ivar'>@description</span> <span class='op'>=</span> <span class='id identifier rubyid_description'>description</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_last_scan-instance_method">
  
    #<strong>update_last_scan</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


559
560
561</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 559</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_last_scan'>update_last_scan</span>
  <span class='ivar'>@last_scan</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="with_connection-instance_method">
  
    #<strong>with_connection</strong>(&amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Execute a block of code with a connection, that is checked out of the server&#39;s pool and then checked back in.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Send a message with the connection.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_with_connection'>with_connection</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_connection'>connection</span><span class='op'>|</span>
  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_dispatch'>dispatch</span><span class='lparen'>(</span><span class='lbracket'>[</span> <span class='id identifier rubyid_command'>command</span> <span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The result of the block execution.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.3.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


428
429
430</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongo/server.rb', line 428</span>

<span class='kw'>def</span> <span class='id identifier rubyid_with_connection'>with_connection</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_pool'>pool</span><span class='period'>.</span><span class='id identifier rubyid_with_connection'>with_connection</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Oct  7 18:11:07 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.25 (ruby-2.7.1).
</div>

    </div>
  </body>
</html>