
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Indexing &#8212; Ruby MongoDB Driver  documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Collations" href="collations.html" />
    <link rel="prev" title="Collections" href="collection-tasks.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Ruby MongoDB Driver  documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../getting-started.html">
   Getting Started
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../installation.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="driver-compatibility.html">
     Driver Compatibility
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../support.html">
     Support
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials.html">
   Tutorials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/quick-start.html">
     Quick Start
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/common-errors.html">
     Common Errors
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="connection-and-configuration.html">
   Connection &amp; Configuration
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="create-client.html">
     Creating a Client
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="authentication.html">
     Authentication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="monitoring.html">
     Monitoring
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="user-management.html">
     User Management
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="working-with-data.html">
   Working With Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="crud-operations.html">
     CRUD Operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="bulk-operations.html">
     Bulk Writes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="projection.html">
     Projection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="aggregation.html">
     Aggregation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="map-reduce.html">
     Map-Reduce
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="text-search.html">
     Text Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="geospatial-search.html">
     Geospatial Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="query-cache.html">
     Query Cache
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gridfs.html">
     GridFS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="change-streams.html">
     Change Streams
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sessions.html">
     Sessions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="transactions.html">
     Transactions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="client-side-encryption.html">
     Client-Side Encryption
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="schema-operations.html">
   Schema Operations
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="database-tasks.html">
     Databases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="collection-tasks.html">
     Collections
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Indexing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="collations.html">
     Collations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://mongodb.com/docs/ruby-driver/master/api/">
   API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../release-notes.html">
   Release Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="additional-resources.html">
   Additional Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contribute.html">
   Contribute to the Driver
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/reference/indexing.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.txt</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-indexes">
   Creating Indexes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-commit-quorum-option">
     The :commit_quorum option
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dropping-indexes">
   Dropping Indexes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#listing-indexes">
   Listing Indexes
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Indexing</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-indexes">
   Creating Indexes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-commit-quorum-option">
     The :commit_quorum option
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dropping-indexes">
   Dropping Indexes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#listing-indexes">
   Listing Indexes
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="indexing">
<h1>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline">#</a></h1>
<div class="contents singlecol local topic" id="on-this-page">
<p class="topic-title">On this page</p>
<ul class="simple">
<li><p><a class="reference internal" href="#creating-indexes" id="id7">Creating Indexes</a></p></li>
<li><p><a class="reference internal" href="#dropping-indexes" id="id8">Dropping Indexes</a></p></li>
<li><p><a class="reference internal" href="#listing-indexes" id="id9">Listing Indexes</a></p></li>
</ul>
</div>
<p>The driver provides the ability to create, drop and view
<a href="#id1"><span class="problematic" id="id2">:manual:`indexes&lt;/indexes/&gt;`</span></a> on a collection through the <code class="docutils literal notranslate"><span class="pre">indexes</span></code> attribute:</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="no">Mongo</span><span class="o">::</span><span class="no">Client</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">[</span> <span class="s1">&#39;127.0.0.1:27017&#39;</span> <span class="o">]</span><span class="p">,</span> <span class="ss">database</span><span class="p">:</span> <span class="s1">&#39;music&#39;</span><span class="p">)</span>
<span class="n">client</span><span class="o">[</span><span class="ss">:bands</span><span class="o">].</span><span class="n">indexes</span>
<span class="c1"># =&gt; #&lt;Mongo::Index::View:0x000055e2822b9318 @collection=#&lt;Mongo::Collection:0x660 namespace=music.bands&gt;, @batch_size=nil, @options={}&gt;</span>
</pre></div>
</div>
<section id="creating-indexes">
<h2>Creating Indexes<a class="headerlink" href="#creating-indexes" title="Permalink to this headline">#</a></h2>
<p>Indexes can be created one at a time, or several can be created in a single
operation. When creating multiple indexes on MongoDB 3.0 and later, the indexes
are created in parallel; on earlier versions they are created sequentially.</p>
<p>To create a single index, use <code class="docutils literal notranslate"><span class="pre">indexes#create_one</span></code>, passing the key
specification as the first argument and options as the second argument:</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">[</span><span class="ss">:bands</span><span class="o">].</span><span class="n">indexes</span><span class="o">.</span><span class="n">create_one</span><span class="p">(</span><span class="ss">genre</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">client</span><span class="o">[</span><span class="ss">:bands</span><span class="o">].</span><span class="n">indexes</span><span class="o">.</span><span class="n">create_one</span><span class="p">(</span>
  <span class="p">{</span> <span class="nb">name</span><span class="p">:</span> <span class="mi">1</span> <span class="p">},</span>
  <span class="ss">unique</span><span class="p">:</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">expire_after</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>To create multiple indexes, use <code class="docutils literal notranslate"><span class="pre">indexes#create_many</span></code> which accepts an array
of index specifications. Unlike <code class="docutils literal notranslate"><span class="pre">create_one</span></code>, each index specification
is a hash with the <code class="docutils literal notranslate"><span class="pre">key</span></code> key mapped to the key specification and the
options being specified on the top level.</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">[</span><span class="ss">:bands</span><span class="o">].</span><span class="n">indexes</span><span class="o">.</span><span class="n">create_many</span><span class="p">(</span><span class="o">[</span>
  <span class="p">{</span> <span class="ss">key</span><span class="p">:</span> <span class="p">{</span> <span class="ss">genre</span><span class="p">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">},</span>
  <span class="p">{</span> <span class="ss">key</span><span class="p">:</span> <span class="p">{</span> <span class="nb">name</span><span class="p">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="ss">unique</span><span class="p">:</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">expire_after</span><span class="p">:</span> <span class="mi">120</span> <span class="p">},</span>
<span class="o">]</span><span class="p">)</span>
</pre></div>
</div>
<p id="index-options">The following is a full list of the available options that can be added
when creating indexes. These options mirror the options supported by the
<a href="#id3"><span class="problematic" id="id4">:manual:`createIndex command&lt;/reference/method/db.collection.createIndex/&gt;`</span></a>.</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 33%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">:background</span></code></p></td>
<td><p>Either <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>. Tells the index to be created in the background.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">:expire_after</span></code></p></td>
<td><p>Number of seconds to expire documents in the collection after.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">:name</span></code></p></td>
<td><p>The name of the index.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">:sparse</span></code></p></td>
<td><p>Whether the index should be sparse or not, either <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">:storage_engine</span></code></p></td>
<td><p>The name of the storage engine for this particular index.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">:version</span></code></p></td>
<td><p>The index format version to use.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">:default_language</span></code></p></td>
<td><p>The default language of text indexes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">:language_override</span></code></p></td>
<td><p>The field name to use when overriding the default language.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">:text_version</span></code></p></td>
<td><p>The version format for text index storage.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">:weights</span></code></p></td>
<td><p>A document specifying fields and weights in text search.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">:sphere_version</span></code></p></td>
<td><p>The 2d sphere index version.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">:bits</span></code></p></td>
<td><p>Sets the maximum boundary for latitude and longitude in the 2d index.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">:max</span></code></p></td>
<td><p>Maximum boundary for latitude and longitude in the 2d index.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">:min</span></code></p></td>
<td><p>Minimum boundary for latitude and longitude in the 2d index.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">:bucket_size</span></code></p></td>
<td><p>The number of units within which to group the location values in a geo haystack index.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">:partial_filter_expression</span></code></p></td>
<td><p>A filter for a partial index.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">:hidden</span></code></p></td>
<td><p>A Boolean specifying whether the index should be hidden; a hidden index
is one that exists on the collection but will not be used by the query planner.</p></td>
</tr>
</tbody>
</table>
<section id="the-commit-quorum-option">
<h3>The :commit_quorum option<a class="headerlink" href="#the-commit-quorum-option" title="Permalink to this headline">#</a></h3>
<p>On MongoDB server versions 4.4 and newer, the <code class="docutils literal notranslate"><span class="pre">:commit_quorum</span></code> option may be
specified on index creation. This option differs from other index options in that
it determines server behavior during index creation, rather than determining
the behavior of an individual index.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">:commit_quorum</span></code> option specifies how many voting, data-bearing members
of a replica set must complete the index build before the index is ready.
Possible values are integers (0 to the number of voting, data-bearing members
of the replica set), “majority”, or “votingMembers”.</p>
<p>To specify <code class="docutils literal notranslate"><span class="pre">:commit_quorum</span></code> when creating one index, add another option
to the second argument of the <code class="docutils literal notranslate"><span class="pre">indexes#create_one</span></code> method:</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">[</span><span class="ss">:bands</span><span class="o">].</span><span class="n">indexes</span><span class="o">.</span><span class="n">create_one</span><span class="p">(</span>
  <span class="p">{</span> <span class="nb">name</span><span class="p">:</span> <span class="mi">1</span> <span class="p">},</span>
  <span class="ss">unique</span><span class="p">:</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">expire_after</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span> <span class="ss">commit_quorum</span><span class="p">:</span> <span class="s1">&#39;majority&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>To specify create options when creating multiple indexes, add a Hash specifying
<code class="docutils literal notranslate"><span class="pre">:commit_quorum</span></code> as a final element to the Array of indexes passed to
<code class="docutils literal notranslate"><span class="pre">indexes#create_many</span></code>. Note that this Hash MUST be the final element in the
Array.</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">[</span><span class="ss">:bands</span><span class="o">].</span><span class="n">indexes</span><span class="o">.</span><span class="n">create_many</span><span class="p">(</span><span class="o">[</span>
  <span class="p">{</span> <span class="ss">key</span><span class="p">:</span> <span class="p">{</span> <span class="ss">genre</span><span class="p">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">},</span>
  <span class="p">{</span> <span class="ss">key</span><span class="p">:</span> <span class="p">{</span> <span class="nb">name</span><span class="p">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="ss">unique</span><span class="p">:</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">expire_after</span><span class="p">:</span> <span class="mi">120</span> <span class="p">},</span>
  <span class="p">{</span> <span class="ss">commit_quorum</span><span class="p">:</span> <span class="s1">&#39;majority&#39;</span> <span class="p">},</span>
<span class="o">]</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="dropping-indexes">
<h2>Dropping Indexes<a class="headerlink" href="#dropping-indexes" title="Permalink to this headline">#</a></h2>
<p>To drop an index, call <code class="docutils literal notranslate"><span class="pre">indexes#drop_one</span></code> or <code class="docutils literal notranslate"><span class="pre">indexes#drop_all</span></code>.</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drops the name_1 index.</span>
<span class="n">client</span><span class="o">[</span><span class="ss">:bands</span><span class="o">].</span><span class="n">indexes</span><span class="o">.</span><span class="n">drop_one</span><span class="p">(</span> <span class="s1">&#39;name_1&#39;</span> <span class="p">)</span>

<span class="c1"># Drops all indexes in the collection.</span>
<span class="n">client</span><span class="o">[</span><span class="ss">:bands</span><span class="o">].</span><span class="n">indexes</span><span class="o">.</span><span class="n">drop_all</span>
</pre></div>
</div>
</section>
<section id="listing-indexes">
<h2>Listing Indexes<a class="headerlink" href="#listing-indexes" title="Permalink to this headline">#</a></h2>
<p>To list the indexes, iterate the <code class="docutils literal notranslate"><span class="pre">indexes</span></code> object:</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">[</span><span class="ss">:bands</span><span class="o">].</span><span class="n">indexes</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">index_spec</span><span class="o">|</span>
  <span class="nb">p</span> <span class="n">index_spec</span>
  <span class="c1"># {&quot;v&quot;=&gt;2, &quot;key&quot;=&gt;{&quot;_id&quot;=&gt;1}, &quot;name&quot;=&gt;&quot;_id_&quot;}</span>
  <span class="c1"># {&quot;v&quot;=&gt;2, &quot;key&quot;=&gt;{&quot;genre&quot;=&gt;1}, &quot;name&quot;=&gt;&quot;genre_1&quot;}</span>
  <span class="c1"># {&quot;v&quot;=&gt;2, &quot;unique&quot;=&gt;true, &quot;key&quot;=&gt;{&quot;name&quot;=&gt;1}, &quot;name&quot;=&gt;&quot;name_1&quot;,</span>
  <span class="c1">#  &quot;expireAfterSeconds&quot;=&gt;120}</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Each iteration returns an index specification as returned by the
<a href="#id5"><span class="problematic" id="id6">:manual:`listIndexes&lt;/reference/command/listIndexes/&gt;`</span></a> command.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The shape and contents of the index specifications returned by this method
may change from one version of MongoDB to another.</p>
</div>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="collection-tasks.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Collections</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="collations.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Collations</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
      &copy; Copyright 2021, MongoDB.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>