
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>User Management &#8212; Ruby MongoDB Driver  documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working With Data" href="working-with-data.html" />
    <link rel="prev" title="Monitoring" href="monitoring.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Ruby MongoDB Driver  documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../getting-started.html">
   Getting Started
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../installation.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="driver-compatibility.html">
     Driver Compatibility
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../support.html">
     Support
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials.html">
   Tutorials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/quick-start.html">
     Quick Start
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/common-errors.html">
     Common Errors
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="connection-and-configuration.html">
   Connection &amp; Configuration
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="create-client.html">
     Creating a Client
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="authentication.html">
     Authentication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="monitoring.html">
     Monitoring
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     User Management
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="working-with-data.html">
   Working With Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="crud-operations.html">
     CRUD Operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="bulk-operations.html">
     Bulk Writes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="projection.html">
     Projection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="aggregation.html">
     Aggregation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="map-reduce.html">
     Map-Reduce
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="text-search.html">
     Text Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="geospatial-search.html">
     Geospatial Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="query-cache.html">
     Query Cache
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gridfs.html">
     GridFS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="change-streams.html">
     Change Streams
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sessions.html">
     Sessions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="transactions.html">
     Transactions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="client-side-encryption.html">
     Client-Side Encryption
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="schema-operations.html">
   Schema Operations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="database-tasks.html">
     Databases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="collection-tasks.html">
     Collections
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="indexing.html">
     Indexing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="collations.html">
     Collations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://mongodb.com/docs/ruby-driver/master/api/">
   API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../release-notes.html">
   Release Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="additional-resources.html">
   Additional Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contribute.html">
   Contribute to the Driver
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/reference/user-management.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.txt</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#users-and-databases">
   Users and Databases
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-users">
   Creating Users
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#user-information">
   User Information
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#updating-users">
   Updating Users
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#removing-users">
   Removing Users
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>User Management</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#users-and-databases">
   Users and Databases
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-users">
   Creating Users
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#user-information">
   User Information
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#updating-users">
   Updating Users
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#removing-users">
   Removing Users
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="user-management">
<span id="id1"></span><h1>User Management<a class="headerlink" href="#user-management" title="Permalink to this headline">#</a></h1>
<div class="contents singlecol local topic" id="on-this-page">
<p class="topic-title">On this page</p>
<ul class="simple">
<li><p><a class="reference internal" href="#users-and-databases" id="id14">Users and Databases</a></p></li>
<li><p><a class="reference internal" href="#creating-users" id="id15">Creating Users</a></p></li>
<li><p><a class="reference internal" href="#user-information" id="id16">User Information</a></p></li>
<li><p><a class="reference internal" href="#updating-users" id="id17">Updating Users</a></p></li>
<li><p><a class="reference internal" href="#removing-users" id="id18">Removing Users</a></p></li>
</ul>
</div>
<p>The Mongo Ruby Driver provides a set of methods for managing users in a
MongoDB deployment. All of these methods are defined on the
<code class="docutils literal notranslate"><span class="pre">Mongo::Auth::User::View</span></code> class, which defines the behavior for
performing user-related operations on a database. You can access a database’s
user view by calling the <code class="docutils literal notranslate"><span class="pre">users</span></code> method on the correpsonding
<code class="docutils literal notranslate"><span class="pre">Mongo::Database</span></code> object:</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">users</span>
</pre></div>
</div>
<p>Note that this will open a view on the database to which the client is already
connected. To interact with the users defined on a different database, call
the client’s <code class="docutils literal notranslate"><span class="pre">use</span></code> method and pass in the name of the database with which
you want to connect:</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="ss">:users</span><span class="p">)</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">users</span>
</pre></div>
</div>
<p>In this example, all operations would be performed on the <code class="docutils literal notranslate"><span class="pre">users</span></code> database.</p>
<p>For more information about users and user management, see MongoDB’s
<a href="#id2"><span class="problematic" id="id3">:manual:`online documentation &lt;/core/security-users&gt;`</span></a>.</p>
<section id="users-and-databases">
<h2>Users and Databases<a class="headerlink" href="#users-and-databases" title="Permalink to this headline">#</a></h2>
<p>When a client connects to the server, MongoDB distinguishes the database
that the client will perform operations on from the <a class="reference external" href="auth-source">auth source</a>
which is the database storing the user that the client is authenticating as.</p>
<p>In many cases, the auth source is the same as the database. When they differ,
user management operations must be done on the auth source database. For
example, to create a user authenticating with X.509 certifcate, which must be
defined on the <code class="docutils literal notranslate"><span class="pre">$external</span></code> database:</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;$external&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
  <span class="s1">&#39;C=US,ST=New York,L=New York City,O=MongoDB,OU=x509,CN=localhost&#39;</span><span class="p">,</span>
  <span class="ss">roles</span><span class="p">:</span> <span class="o">[</span><span class="p">{</span><span class="ss">role</span><span class="p">:</span> <span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="ss">db</span><span class="p">:</span> <span class="s1">&#39;admin&#39;</span><span class="p">}</span><span class="o">]</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Note that the auth source is not specified for creating the user - auth source
is only used during the authentication process. If <code class="docutils literal notranslate"><span class="pre">#create</span></code> is invoked with
a <code class="docutils literal notranslate"><span class="pre">User</span></code> object with <code class="docutils literal notranslate"><span class="pre">auth_source</span></code> set, the auth source is ignored for
the purposes of user management.</p>
</section>
<section id="creating-users">
<h2>Creating Users<a class="headerlink" href="#creating-users" title="Permalink to this headline">#</a></h2>
<p>There are two ways to create a new database user with the Ruby Driver.</p>
<p>The simplest way to create a new user is to use the <code class="docutils literal notranslate"><span class="pre">create</span></code> method,
passing in a username, password, and roles:</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
  <span class="s1">&#39;alanturing&#39;</span><span class="p">,</span>
  <span class="ss">password</span><span class="p">:</span> <span class="s1">&#39;enigma&#39;</span><span class="p">,</span>
  <span class="ss">roles</span><span class="p">:</span> <span class="o">[</span> <span class="no">Mongo</span><span class="o">::</span><span class="no">Auth</span><span class="o">::</span><span class="no">Roles</span><span class="o">::</span><span class="no">READWRITE</span> <span class="o">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Another way to create a user is to first create a <code class="docutils literal notranslate"><span class="pre">Mongo::Auth::User</span></code> object
with all the user information and then pass that object into the <code class="docutils literal notranslate"><span class="pre">create</span></code>
method instead.</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">user</span> <span class="o">=</span> <span class="no">Mongo</span><span class="o">::</span><span class="no">User</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
  <span class="ss">user</span><span class="p">:</span> <span class="s1">&#39;alanturing&#39;</span><span class="p">,</span>
  <span class="ss">password</span><span class="p">:</span> <span class="s1">&#39;enigma&#39;</span><span class="p">,</span>
  <span class="ss">roles</span><span class="p">:</span> <span class="o">[</span> <span class="no">Mongo</span><span class="o">::</span><span class="no">Auth</span><span class="o">::</span><span class="no">Roles</span><span class="o">::</span><span class="no">READWRITE</span> <span class="o">]</span>
<span class="p">)</span>

<span class="n">client</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that your new user’s credentials will be stored in whatever database your
<code class="docutils literal notranslate"><span class="pre">client</span></code> object is currently connected to. This will be your user’s
<code class="docutils literal notranslate"><span class="pre">auth_source</span></code>, and you must be connected to that same database in order to
update, remove, or get information about the user you just created in the future.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">create</span></code> method takes a <code class="docutils literal notranslate"><span class="pre">Hash</span></code> of options as an optional second argument.
The <code class="docutils literal notranslate"><span class="pre">:roles</span></code> option allows you to grant permissions to the new user.
For example, the <code class="docutils literal notranslate"><span class="pre">Mongo::Auth::Roles::READ_WRITE</span></code> role grants the user the
ability to both read from and write to the database in which they were created.
Each role can be specified as a <code class="docutils literal notranslate"><span class="pre">String</span></code> or as a <code class="docutils literal notranslate"><span class="pre">Hash</span></code>. If you would like
to grant permissions to a user on a database other than the one on which they
were created, you can pass that database name in the role <code class="docutils literal notranslate"><span class="pre">Hash</span></code>. To create
a user <code class="docutils literal notranslate"><span class="pre">alanturing</span></code> with permission to read and write on the <code class="docutils literal notranslate"><span class="pre">machines</span></code>
database, you could execute the following code:</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
  <span class="s1">&#39;alanturing&#39;</span><span class="p">,</span>
  <span class="ss">password</span><span class="p">:</span> <span class="s1">&#39;enigma&#39;</span><span class="p">,</span>
  <span class="ss">roles</span><span class="p">:</span> <span class="o">[</span><span class="p">{</span> <span class="ss">role</span><span class="p">:</span> <span class="no">Mongo</span><span class="o">::</span><span class="no">Auth</span><span class="o">::</span><span class="no">Roles</span><span class="o">::</span><span class="no">READWRITE</span><span class="p">,</span> <span class="ss">db</span><span class="p">:</span> <span class="s1">&#39;machines&#39;</span> <span class="p">}</span><span class="o">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>For more information about roles in MongoDB, see the
<a href="#id4"><span class="problematic" id="id5">:manual:`Built-in roles&lt;/reference/built-in-roles/&gt;`</span></a> documentation.</p>
<p>In addition to the <code class="docutils literal notranslate"><span class="pre">:roles</span></code> option, the <code class="docutils literal notranslate"><span class="pre">create</span></code> method supports a
<code class="docutils literal notranslate"><span class="pre">:session</span></code> option, which allows you to specify a <code class="docutils literal notranslate"><span class="pre">Mongo::Session</span></code> object
to use for this operation, as well as a <code class="docutils literal notranslate"><span class="pre">:write_concern</span></code> option,
which specifies the write concern of this operation when performed on a
replica set.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a href="#id6"><span class="problematic" id="id7">:manual:`Built-in roles&lt;/reference/built-in-roles/&gt;`</span></a>
<a href="#id8"><span class="problematic" id="id9">:manual:`Write Concerns&lt;/core/replica-set-write-concern/&gt;`</span></a>,
<a class="reference internal" href="sessions.html#sessions"><span class="std std-ref">Sessions</span></a>,</p>
</div>
</section>
<section id="user-information">
<h2>User Information<a class="headerlink" href="#user-information" title="Permalink to this headline">#</a></h2>
<p>To view information about a user that already exists in the database, use the
<code class="docutils literal notranslate"><span class="pre">info</span></code> method:</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;alanturing&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If the user exists, this method will return an <code class="docutils literal notranslate"><span class="pre">Array</span></code> object containing a
<code class="docutils literal notranslate"><span class="pre">Hash</span></code> with information about the user, such as their id, username, the
database they were created on, and their roles. If the user doesn’t exist,
this method will return an empty Array.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">info</span></code> method also takes an optional <code class="docutils literal notranslate"><span class="pre">Hash</span></code> of options as a second
argument. Currently, the only supported option is <code class="docutils literal notranslate"><span class="pre">:session</span></code>, which allows
you to specify a <code class="docutils literal notranslate"><span class="pre">Mongo::Session</span></code> object to use for this operation.</p>
<p>The Ruby Driver does not have a method that lists all of the users that
currently exist in a database.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="sessions.html#sessions"><span class="std std-ref">Sessions</span></a></p>
</div>
</section>
<section id="updating-users">
<h2>Updating Users<a class="headerlink" href="#updating-users" title="Permalink to this headline">#</a></h2>
<p>To update a user that already exists in the database, you can use the
<code class="docutils literal notranslate"><span class="pre">update</span></code> method in one of two ways. The first way is to specify the name of
the user you wish to update, along with a new set of options.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You must include all user options in the options <code class="docutils literal notranslate"><span class="pre">Hash</span></code>, even those options
whose values will remain the same. Omitting an option is the same as setting
it to an empty value.</p>
</div>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
  <span class="s1">&#39;alanturing&#39;</span><span class="p">,</span>
  <span class="ss">roles</span><span class="p">:</span> <span class="o">[</span> <span class="no">Mongo</span><span class="o">::</span><span class="no">Auth</span><span class="o">::</span><span class="no">Roles</span><span class="o">::</span><span class="no">READ_WRITE</span> <span class="o">]</span>
  <span class="ss">password</span><span class="p">:</span> <span class="s1">&#39;turing-test&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The second way to update a user is to pass an updated <code class="docutils literal notranslate"><span class="pre">Mongo::Auth::User</span></code>
object to the <code class="docutils literal notranslate"><span class="pre">update</span></code> method in lieu of a username.</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">user</span> <span class="o">=</span> <span class="no">Mongo</span><span class="o">::</span><span class="no">Auth</span><span class="o">::</span><span class="no">User</span><span class="o">.</span><span class="n">new</span><span class="p">({</span>
  <span class="ss">user</span><span class="p">:</span> <span class="s1">&#39;alanturing&#39;</span><span class="p">,</span>
  <span class="ss">roles</span><span class="p">:</span> <span class="o">[</span> <span class="no">Mongo</span><span class="o">::</span><span class="no">Auth</span><span class="o">::</span><span class="no">Roles</span><span class="o">::</span><span class="no">READ_WRITE</span> <span class="o">]</span><span class="p">,</span>
  <span class="ss">password</span><span class="p">:</span> <span class="s1">&#39;turing-test&#39;</span>
<span class="p">})</span>

<span class="n">client</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
<p>Optionally, the <code class="docutils literal notranslate"><span class="pre">update</span></code> method takes a <code class="docutils literal notranslate"><span class="pre">Hash</span></code> of options as a second
argument. The two possible options for this method are <code class="docutils literal notranslate"><span class="pre">:session</span></code>, which
allows you to specify a <code class="docutils literal notranslate"><span class="pre">Mongo::Session</span></code> object on which to perform this
operation, and <code class="docutils literal notranslate"><span class="pre">:write_concern</span></code>, which sets a write concern if this operation
is performed on a replica set.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="sessions.html#sessions"><span class="std std-ref">Sessions</span></a>
<a href="#id10"><span class="problematic" id="id11">:manual:`Write Concerns&lt;/core/replica-set-write-concern/&gt;`</span></a>,</p>
</div>
</section>
<section id="removing-users">
<h2>Removing Users<a class="headerlink" href="#removing-users" title="Permalink to this headline">#</a></h2>
<p>To remove a user from the database, use the <code class="docutils literal notranslate"><span class="pre">remove</span></code> method:</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;alanturing&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You may pass a <code class="docutils literal notranslate"><span class="pre">Hash</span></code> of options as a second argument. The two supported
options for the <code class="docutils literal notranslate"><span class="pre">remove</span></code> method are <code class="docutils literal notranslate"><span class="pre">:session</span></code> and <code class="docutils literal notranslate"><span class="pre">:write_concern</span></code>.
<code class="docutils literal notranslate"><span class="pre">:session</span></code> allows you to specify a <code class="docutils literal notranslate"><span class="pre">Mongo::Session</span></code> object to use for
this operation. <code class="docutils literal notranslate"><span class="pre">:write_concern</span></code> specifies the write concern
of the operation if you are running this command against a replica set.</p>
<p>The Ruby Driver does not provide a method for removing all users
from a database.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="sessions.html#sessions"><span class="std std-ref">Sessions</span></a>
<a href="#id12"><span class="problematic" id="id13">:manual:`Write Concerns&lt;/core/replica-set-write-concern/&gt;`</span></a>,</p>
</div>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="monitoring.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Monitoring</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="working-with-data.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Working With Data</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
      &copy; Copyright 2021, MongoDB.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>