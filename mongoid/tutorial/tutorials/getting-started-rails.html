
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Getting Started (Rails) &#8212; Mongoid  documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Documents" href="documents.html" />
    <link rel="prev" title="Getting Started (Sinatra)" href="getting-started-sinatra.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Mongoid  documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../installation-configuration.html">
   Installation &amp; Configuration
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../installation.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/compatibility.html">
     Compatibility
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/configuration.html">
     Configuration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/rails-integration.html">
     Rails Integration
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../tutorials.html">
   Tutorials
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="getting-started-sinatra.html">
     Getting Started (Sinatra)
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Getting Started (Rails)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="documents.html">
     Documents
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="common-errors.html">
     Common Errors
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../schema-configuration.html">
   Schema Configuration
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/fields.html">
     Field Definition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/inheritance.html">
     Inheritance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/associations.html">
     Associations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/validation.html">
     Validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/collection-configuration.html">
     Collection Configuration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/indexes.html">
     Index Management
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/sharding.html">
     Sharding Configuration
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../working-with-data.html">
   Working With Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/crud.html">
     CRUD Operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/queries.html">
     Queries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/text-search.html">
     Text Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/aggregation.html">
     Aggregation Pipeline
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/map-reduce.html">
     Map/Reduce
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/persistence-configuration.html">
     Persistence Configuration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/nested-attributes.html">
     Nested Attributes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/callbacks.html">
     Callbacks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/sessions.html">
     Sessions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference/transactions.html">
     Transactions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://mongodb.com/docs/mongoid/master/api/">
   API
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../release-notes.html">
   Release Notes
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../release-notes/mongoid-8.0.html">
     Mongoid 8.0
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../release-notes/mongoid-7.4.html">
     Mongoid 7.4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../release-notes/mongoid-7.3.html">
     Mongoid 7.3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../release-notes/mongoid-7.2.html">
     Mongoid 7.2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../release-notes/mongoid-7.1.html">
     Mongoid 7.1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../release-notes/mongoid-7.0.html">
     Mongoid 7.0
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../release-notes/mongoid-6.html">
     Mongoid 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../release-notes/mongoid-5.html">
     Mongoid 5
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../additional-resources.html">
   Additional Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ecosystem.html">
   Ecosystem
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/tutorials/getting-started-rails.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.txt</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#new-application">
   New Application
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-rails">
     Install
     <code class="docutils literal notranslate">
      <span class="pre">
       rails
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-new-application">
     Create New Application
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-git-repo">
     Create Git Repo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-mongoid">
     Add Mongoid
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-mongodb-locally">
     Run MongoDB Locally
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-mongodb-atlas">
     Use MongoDB Atlas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-rails-dependencies">
     Other Rails Dependencies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-application">
     Run Application
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-posts">
     Add Posts
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-comments">
     Add Comments
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#existing-application">
   Existing Application
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dependencies">
     Dependencies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loaded-frameworks">
     Loaded Frameworks
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#activerecord-configuration">
     ActiveRecord Configuration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stop-spring">
     Stop Spring
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mongoid-configuration">
     Mongoid Configuration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adjust-models">
     Adjust Models
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-migration">
     Data Migration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rails-api">
     Rails API
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Getting Started (Rails)</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#new-application">
   New Application
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-rails">
     Install
     <code class="docutils literal notranslate">
      <span class="pre">
       rails
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-new-application">
     Create New Application
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-git-repo">
     Create Git Repo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-mongoid">
     Add Mongoid
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-mongodb-locally">
     Run MongoDB Locally
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-mongodb-atlas">
     Use MongoDB Atlas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-rails-dependencies">
     Other Rails Dependencies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-application">
     Run Application
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-posts">
     Add Posts
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-comments">
     Add Comments
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#existing-application">
   Existing Application
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dependencies">
     Dependencies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loaded-frameworks">
     Loaded Frameworks
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#activerecord-configuration">
     ActiveRecord Configuration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stop-spring">
     Stop Spring
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mongoid-configuration">
     Mongoid Configuration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adjust-models">
     Adjust Models
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-migration">
     Data Migration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rails-api">
     Rails API
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="getting-started-rails">
<h1>Getting Started (Rails)<a class="headerlink" href="#getting-started-rails" title="Permalink to this headline">#</a></h1>
<div class="contents singlecol local topic" id="on-this-page">
<p class="topic-title">On this page</p>
<ul class="simple">
<li><p><a class="reference internal" href="#new-application" id="id6">New Application</a></p>
<ul>
<li><p><a class="reference internal" href="#install-rails" id="id7">Install <code class="docutils literal notranslate"><span class="pre">rails</span></code></a></p></li>
<li><p><a class="reference internal" href="#create-new-application" id="id8">Create New Application</a></p></li>
<li><p><a class="reference internal" href="#create-git-repo" id="id9">Create Git Repo</a></p></li>
<li><p><a class="reference internal" href="#add-mongoid" id="id10">Add Mongoid</a></p></li>
<li><p><a class="reference internal" href="#run-mongodb-locally" id="id11">Run MongoDB Locally</a></p></li>
<li><p><a class="reference internal" href="#use-mongodb-atlas" id="id12">Use MongoDB Atlas</a></p></li>
<li><p><a class="reference internal" href="#other-rails-dependencies" id="id13">Other Rails Dependencies</a></p></li>
<li><p><a class="reference internal" href="#run-application" id="id14">Run Application</a></p></li>
<li><p><a class="reference internal" href="#add-posts" id="id15">Add Posts</a></p></li>
<li><p><a class="reference internal" href="#add-comments" id="id16">Add Comments</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#existing-application" id="id17">Existing Application</a></p>
<ul>
<li><p><a class="reference internal" href="#dependencies" id="id18">Dependencies</a></p></li>
<li><p><a class="reference internal" href="#loaded-frameworks" id="id19">Loaded Frameworks</a></p></li>
<li><p><a class="reference internal" href="#activerecord-configuration" id="id20">ActiveRecord Configuration</a></p></li>
<li><p><a class="reference internal" href="#stop-spring" id="id21">Stop Spring</a></p></li>
<li><p><a class="reference internal" href="#mongoid-configuration" id="id22">Mongoid Configuration</a></p></li>
<li><p><a class="reference internal" href="#adjust-models" id="id23">Adjust Models</a></p></li>
<li><p><a class="reference internal" href="#data-migration" id="id24">Data Migration</a></p></li>
<li><p><a class="reference internal" href="#rails-api" id="id25">Rails API</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="new-application">
<h2>New Application<a class="headerlink" href="#new-application" title="Permalink to this headline">#</a></h2>
<p>This section shows how to create a new Ruby on Rails application using Mongoid
for data access. The application will be similar to the blog application
described in the <a class="reference external" href="https://guides.rubyonrails.org/getting_started.html#creating-the-blog-application">Ruby on Rails Getting Started</a>
guide, however using Mongoid instead of ActiveRecord as the database adapter.</p>
<p>The complete source code for this application can be found in the
<a class="reference external" href="https://github.com/mongoid/mongoid-demo/tree/master/rails">mongoid-demo GitHub repository</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This guide assumes basic familiarity with Ruby on Rails.
To learn more about Ruby on Rails, please refer to its <a class="reference external" href="https://guides.rubyonrails.org/getting_started.html">Getting Started
guide</a> or
other Rails guides.</p>
</div>
<section id="install-rails">
<h3>Install <code class="docutils literal notranslate"><span class="pre">rails</span></code><a class="headerlink" href="#install-rails" title="Permalink to this headline">#</a></h3>
<p>We will use a Rails generator to create the application skeleton.
In order to do so, the first step is to install the <code class="docutils literal notranslate"><span class="pre">rails</span></code> gem:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>gem install rails -v <span class="s1">&#39;~&gt; 6.0.0&#39;</span>
</pre></div>
</div>
</section>
<section id="create-new-application">
<h3>Create New Application<a class="headerlink" href="#create-new-application" title="Permalink to this headline">#</a></h3>
<p>Use the <code class="docutils literal notranslate"><span class="pre">rails</span></code> command to create the application skeleton, as follows:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rails new blog --skip-active-record --skip-bundle
<span class="nb">cd</span> blog
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You may receive a warning like this:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>Could not find gem <span class="s1">&#39;puma (~&gt; 3.11)&#39;</span> <span class="k">in</span> any of the gem sources listed <span class="k">in</span> your Gemfile.
Run <span class="sb">`</span>bundle install<span class="sb">`</span> to install missing gems.
</pre></div>
</div>
<p>Disregard it as we will be taking care of gem installation
in a moment.</p>
</div>
<p>We pass <code class="docutils literal notranslate"><span class="pre">--skip-active-record</span></code> to request that ActiveRecord is not added
as a dependency, because we will be using Mongoid instead. Additionally
we pass <code class="docutils literal notranslate"><span class="pre">--skip-bundle</span></code> because we’ll be modifying the <code class="docutils literal notranslate"><span class="pre">Gemfile</span></code> to
add the <code class="docutils literal notranslate"><span class="pre">mongoid</span></code> dependency.</p>
<p>If you intend to test your application with RSpec, you can instruct the
generator to omit default Rails test setup by passing <code class="docutils literal notranslate"><span class="pre">--skip-test</span></code>
and <code class="docutils literal notranslate"><span class="pre">--skip-system-test</span></code> options:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rails new blog --skip-bundle --skip-active-record --skip-test --skip-system-test
<span class="nb">cd</span> blog
</pre></div>
</div>
</section>
<section id="create-git-repo">
<h3>Create Git Repo<a class="headerlink" href="#create-git-repo" title="Permalink to this headline">#</a></h3>
<p>While not required, we recommend creating a Git repository for your application:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git init .
git add .
git commit
</pre></div>
</div>
<p>Commit your changes as you are following this tutorial.</p>
</section>
<section id="add-mongoid">
<h3>Add Mongoid<a class="headerlink" href="#add-mongoid" title="Permalink to this headline">#</a></h3>
<p>1. Modify the <code class="docutils literal notranslate"><span class="pre">Gemfile</span></code> to add a reference to the
<a class="reference external" href="https://rubygems.org/gems/mongoid/">mongoid</a> gem:</p>
<div class="literal-block-wrapper docutils container" id="gemfile">
<div class="code-block-caption"><span class="caption-text">Gemfile</span><a class="headerlink" href="#gemfile" title="Permalink to this code">#</a></div>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span>  <span class="n">gem</span> <span class="s1">&#39;mongoid&#39;</span><span class="p">,</span> <span class="s1">&#39;~&gt; 7.0.5&#39;</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Mongoid 7.0.5 or higher is required to use Rails 6.0.</p>
</div>
<ol class="arabic simple" start="2">
<li><p>Install gem dependencies:</p></li>
</ol>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bundle install
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Generate the default Mongoid configuration:</p></li>
</ol>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bin/rails g mongoid:config
</pre></div>
</div>
<p>This generator will create the <code class="docutils literal notranslate"><span class="pre">config/mongoid.yml</span></code> configuration file,
which is used to configure the connection to the MongoDB deployment.
Note that as we are not using ActiveRecord we will not have a <code class="docutils literal notranslate"><span class="pre">database.yml</span></code>
file.</p>
</section>
<section id="run-mongodb-locally">
<h3>Run MongoDB Locally<a class="headerlink" href="#run-mongodb-locally" title="Permalink to this headline">#</a></h3>
<p>The configuration created in the previous step is suitable when
a MongoDB server is running locally. If you do not already have a
local MongoDB server, <a class="reference external" href="https://mongodb.com/docs/manual/installation/">download and install MongoDB</a>.</p>
<p>While the generated <code class="docutils literal notranslate"><span class="pre">mongoid.yml</span></code> will work without modifications,
we recommend reducing the server selection timeout for development.
With this change, the uncommented lines of <code class="docutils literal notranslate"><span class="pre">mongoid.yml</span></code> should look
like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>development:
  clients:
    default:
      database: blog_development
      hosts:
        - localhost:27017
      options:
        server_selection_timeout: 1
</pre></div>
</div>
</section>
<section id="use-mongodb-atlas">
<h3>Use MongoDB Atlas<a class="headerlink" href="#use-mongodb-atlas" title="Permalink to this headline">#</a></h3>
<p>Instead of downloading, installing and running MongoDB locally, you can create
a free MongoDB Atlas account and create a <a class="reference external" href="https://mongodb.com/docs/manual/tutorial/atlas-free-tier-setup/">free MongoDB cluster in Atlas</a>.
Once the cluster is created, follow the instructions in <a class="reference external" href="https://docs.atlas.mongodb.com/connect-to-cluster/#connect-to-a-cluster">connect to the cluster
page</a>
to obtain the URI. Use the <em>Ruby driver 2.5 or later</em> format.</p>
<p>Paste the URI into the <code class="docutils literal notranslate"><span class="pre">config/mongoid.yml</span></code> file, and comment out the
hosts that are defined. We recommend setting the server selection timeout to 5
seconds for development environment when using Atlas.</p>
<p>The uncommented contents of <code class="docutils literal notranslate"><span class="pre">config/mongoid.yml</span></code> should look like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">development</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">clients</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mongodb+srv://user:pass@yourcluster.mongodb.net/blog_development?retryWrites=true&amp;w=majority</span><span class="w"></span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">server_selection_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="other-rails-dependencies">
<h3>Other Rails Dependencies<a class="headerlink" href="#other-rails-dependencies" title="Permalink to this headline">#</a></h3>
<p>If this is the first Rails application you are creating, you may need to
install Node.js on your computer. This can be done via your operating system
packages or by <a class="reference external" href="https://nodejs.org/en/download/">downloading a binary</a>.</p>
<p>Next, if you do not have Yarn installed, <a class="reference external" href="https://yarnpkg.com/lang/en/docs/install/">follow its installation instructions</a>.</p>
<p>Finally, install webpacker:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rails webpacker:install
</pre></div>
</div>
</section>
<section id="run-application">
<h3>Run Application<a class="headerlink" href="#run-application" title="Permalink to this headline">#</a></h3>
<p>You can now start the application server by running:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rails s
</pre></div>
</div>
<p>Access the application by navigating to <a class="reference external" href="http://localhost:3000">localhost:3000</a>.</p>
</section>
<section id="add-posts">
<h3>Add Posts<a class="headerlink" href="#add-posts" title="Permalink to this headline">#</a></h3>
<p>Using the standard Rails scaffolding, Mongoid can generate the necessary
model, controller and view files for our blog so that we can quickly begin
creating blog posts:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bin/rails g scaffold Post title:string body:text
</pre></div>
</div>
<p>Navigate to <a class="reference external" href="http://localhost:3000/posts">localhost:3000/posts</a>
to create posts and see the posts that have already been created.</p>
<img alt="Screenshot of the new blog" src="../_images/rails-new-blog.png" />
</section>
<section id="add-comments">
<h3>Add Comments<a class="headerlink" href="#add-comments" title="Permalink to this headline">#</a></h3>
<p>To make our application more interactive, let’s add the ability for users to
add comments to our posts.</p>
<p>Create the <code class="docutils literal notranslate"><span class="pre">Comment</span></code> model:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bin/rails g scaffold Comment name:string message:string post:belongs_to
</pre></div>
</div>
<p>Open the <code class="docutils literal notranslate"><span class="pre">Post</span></code> model file, <code class="docutils literal notranslate"><span class="pre">app/models/post.rb</span></code>, and add a <code class="docutils literal notranslate"><span class="pre">has_many</span></code>
association for the comments:</p>
<div class="literal-block-wrapper docutils container" id="app-models-post-rb">
<div class="code-block-caption"><span class="caption-text">app/models/post.rb</span><a class="headerlink" href="#app-models-post-rb" title="Permalink to this code">#</a></div>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span>  <span class="k">class</span> <span class="nc">Post</span>
    <span class="kp">include</span> <span class="no">Mongoid</span><span class="o">::</span><span class="no">Document</span>

    <span class="n">field</span> <span class="ss">:title</span><span class="p">,</span> <span class="ss">type</span><span class="p">:</span> <span class="nb">String</span>
    <span class="n">field</span> <span class="ss">:body</span><span class="p">,</span> <span class="ss">type</span><span class="p">:</span> <span class="nb">String</span>

    <span class="n">has_many</span> <span class="ss">:comments</span><span class="p">,</span> <span class="ss">dependent</span><span class="p">:</span> <span class="ss">:destroy</span>
  <span class="k">end</span>
</pre></div>
</div>
</div>
<p>Open the <code class="docutils literal notranslate"><span class="pre">Comment</span></code> model file, <code class="docutils literal notranslate"><span class="pre">app/models/comment.rb</span></code>, and change the
generated <code class="docutils literal notranslate"><span class="pre">embedded_in</span></code> association to <code class="docutils literal notranslate"><span class="pre">belongs_to</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="app-models-comment-rb">
<div class="code-block-caption"><span class="caption-text">app/models/comment.rb</span><a class="headerlink" href="#app-models-comment-rb" title="Permalink to this code">#</a></div>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span>  <span class="k">class</span> <span class="nc">Comment</span>
    <span class="kp">include</span> <span class="no">Mongoid</span><span class="o">::</span><span class="no">Document</span>

    <span class="n">field</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">type</span><span class="p">:</span> <span class="nb">String</span>
    <span class="n">field</span> <span class="ss">:message</span><span class="p">,</span> <span class="ss">type</span><span class="p">:</span> <span class="nb">String</span>

    <span class="n">belongs_to</span> <span class="ss">:post</span>
  <span class="k">end</span>
</pre></div>
</div>
</div>
<p>Open the post show view file, <code class="docutils literal notranslate"><span class="pre">app/views/posts/show.html.erb</span></code>, and add
a section rendering existing comments and prompting to leave a new comment:</p>
<div class="literal-block-wrapper docutils container" id="app-views-posts-show-html-erb">
<div class="code-block-caption"><span class="caption-text">app/views/posts/show.html.erb</span><a class="headerlink" href="#app-views-posts-show-html-erb" title="Permalink to this code">#</a></div>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span>&lt;section class=&quot;section comments&quot;&gt;
  &lt;div class=&quot;container&quot;&gt;
    &lt;h2 class=&quot;subtitle is-5&quot;&gt;
      &lt;strong&gt;&lt;%= @post.comments.count %&gt;&lt;/strong&gt; Comments
    &lt;/h2&gt;
    &lt;%= render @post.comments %&gt;
    &lt;div class=&quot;comment-form&quot;&gt;
      &lt;hr /&gt;
      &lt;h3 class=&quot;subtitle is-3&quot;&gt;Leave a reply&lt;/h3&gt;
      &lt;%= render partial: &#39;comments/form&#39;, locals: { comment: @post.comments.build } %&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/section&gt;
</pre></div>
</div>
</div>
<p>Open the comment form file and change the type of field for <code class="docutils literal notranslate"><span class="pre">:message</span></code>
from <code class="docutils literal notranslate"><span class="pre">text_field</span></code> to <code class="docutils literal notranslate"><span class="pre">text_area</span></code>, as well as the type of field for
<code class="docutils literal notranslate"><span class="pre">:post_id</span></code> from <code class="docutils literal notranslate"><span class="pre">text_field</span></code> to <code class="docutils literal notranslate"><span class="pre">hidden_field</span></code>. The result
should look like this:</p>
<div class="literal-block-wrapper docutils container" id="app-views-comments-form-html-erb">
<div class="code-block-caption"><span class="caption-text">app/views/comments/_form.html.erb</span><a class="headerlink" href="#app-views-comments-form-html-erb" title="Permalink to this code">#</a></div>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span>&lt;%= form_with(model: comment, local: true) do |form| %&gt;
  &lt;% if comment.errors.any? %&gt;
    &lt;div id=&quot;error_explanation&quot;&gt;
      &lt;h2&gt;&lt;%= pluralize(comment.errors.count, &quot;error&quot;) %&gt; prohibited this comment from being saved:&lt;/h2&gt;

      &lt;ul&gt;
        &lt;% comment.errors.full_messages.each do |message| %&gt;
          &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;
        &lt;% end %&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;% end %&gt;

  &lt;div class=&quot;field&quot;&gt;
    &lt;%= form.label :name %&gt;
    &lt;%= form.text_field :name %&gt;
  &lt;/div&gt;

  &lt;div class=&quot;field&quot;&gt;
    &lt;%= form.label :message %&gt;
    &lt;%= form.text_area :message %&gt;
  &lt;/div&gt;

  &lt;div class=&quot;field&quot;&gt;
    &lt;%= form.hidden_field :post_id %&gt;
  &lt;/div&gt;

  &lt;div class=&quot;actions&quot;&gt;
    &lt;%= form.submit %&gt;
  &lt;/div&gt;
&lt;% end %&gt;
</pre></div>
</div>
</div>
<p>Create a partial for the comment view, <code class="docutils literal notranslate"><span class="pre">app/view/comments/_comment.html.erb</span></code>
with the following contents:</p>
<div class="literal-block-wrapper docutils container" id="app-views-comments-comment-html-erb">
<div class="code-block-caption"><span class="caption-text">app/views/comments/_comment.html.erb</span><a class="headerlink" href="#app-views-comments-comment-html-erb" title="Permalink to this code">#</a></div>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span>&lt;p&gt;
  &lt;strong&gt;&lt;%= comment.name %&gt;:&lt;/strong&gt;
  &lt;%= comment.message %&gt;
&lt;br&gt;
&lt;%= link_to &#39;Delete&#39;, [comment],
  method: :delete,
  class: &quot;button is-danger&quot;,
  data: { confirm: &#39;Are you sure?&#39; } %&gt;
&lt;/p&gt;
</pre></div>
</div>
</div>
<p>You should now be able to leave comments for the posts:</p>
<img alt="Screenshot of the blog with a new comment being added" src="../_images/rails-blog-new-comment.png" />
</section>
</section>
<section id="existing-application">
<h2>Existing Application<a class="headerlink" href="#existing-application" title="Permalink to this headline">#</a></h2>
<p>Follow these steps to switch an existing Ruby on Rails application to use
Mongoid instead of ActiveRecord.</p>
<section id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">#</a></h3>
<p>Remove or comment out any RDBMS libraries like <code class="docutils literal notranslate"><span class="pre">sqlite</span></code>, <code class="docutils literal notranslate"><span class="pre">pg</span></code> etc.
mentioned in <code class="docutils literal notranslate"><span class="pre">Gemfile</span></code>, and add <code class="docutils literal notranslate"><span class="pre">mongoid</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Gemfile</span><a class="headerlink" href="#id1" title="Permalink to this code">#</a></div>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span>  <span class="n">gem</span> <span class="s1">&#39;mongoid&#39;</span><span class="p">,</span> <span class="s1">&#39;~&gt; 7.0.5&#39;</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Mongoid 7.0.5 or higher is required to use Rails 6.0.</p>
</div>
<p>Install gem dependencies:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bundle install
</pre></div>
</div>
</section>
<section id="loaded-frameworks">
<h3>Loaded Frameworks<a class="headerlink" href="#loaded-frameworks" title="Permalink to this headline">#</a></h3>
<p>Examine <code class="docutils literal notranslate"><span class="pre">config/application.rb</span></code>. If it is requiring all components of Rails
via <code class="docutils literal notranslate"><span class="pre">require</span> <span class="pre">'rails/all'</span></code>, change it to require individual frameworks:</p>
<div class="literal-block-wrapper docutils container" id="config-application-rb">
<div class="code-block-caption"><span class="caption-text">config/application.rb</span><a class="headerlink" href="#config-application-rb" title="Permalink to this code">#</a></div>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove or comment out</span>
<span class="c1">#require &quot;rails/all&quot;</span>

<span class="c1"># Add this require instead of &quot;rails/all&quot;:</span>
<span class="nb">require</span> <span class="s2">&quot;rails&quot;</span>

<span class="c1"># Pick the frameworks you want:</span>
<span class="nb">require</span> <span class="s2">&quot;active_model/railtie&quot;</span>
<span class="nb">require</span> <span class="s2">&quot;active_job/railtie&quot;</span>
<span class="nb">require</span> <span class="s2">&quot;action_controller/railtie&quot;</span>
<span class="nb">require</span> <span class="s2">&quot;action_mailer/railtie&quot;</span>
<span class="c1"># require &quot;action_mailbox/engine&quot;</span>
<span class="c1"># require &quot;action_text/engine&quot;</span>
<span class="nb">require</span> <span class="s2">&quot;action_view/railtie&quot;</span>
<span class="nb">require</span> <span class="s2">&quot;action_cable/engine&quot;</span>
<span class="nb">require</span> <span class="s2">&quot;sprockets/railtie&quot;</span>
<span class="nb">require</span> <span class="s2">&quot;rails/test_unit/railtie&quot;</span>

<span class="c1"># Remove or comment out ActiveRecord and ActiveStorage:</span>
<span class="c1"># require &quot;active_record/railtie&quot;</span>
<span class="c1"># require &quot;active_storage/engine&quot;</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At this time ActiveStorage requires ActiveRecord and is not usable with
Mongoid.</p>
</div>
</section>
<section id="activerecord-configuration">
<h3>ActiveRecord Configuration<a class="headerlink" href="#activerecord-configuration" title="Permalink to this headline">#</a></h3>
<p>Review all configuration files (<code class="docutils literal notranslate"><span class="pre">config/application.rb</span></code>,
<code class="docutils literal notranslate"><span class="pre">config/environments/{development,production.test}.rb</span></code>) and remove or
comment out any references to <code class="docutils literal notranslate"><span class="pre">config.active_record</span></code> and
<code class="docutils literal notranslate"><span class="pre">config.active_storage</span></code>.</p>
</section>
<section id="stop-spring">
<h3>Stop Spring<a class="headerlink" href="#stop-spring" title="Permalink to this headline">#</a></h3>
<p>If your application is using Spring, which is the default on Rails 6,
Spring must be stopped after changing dependencies or configuration.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./bin/spring stop
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sometimes running <code class="docutils literal notranslate"><span class="pre">./bin/spring</span> <span class="pre">stop</span></code> claims to stop Spring, but does
not. Verify that all Spring processes are terminated before proceeding.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sometimes Spring tries to load ActiveRecord even when the application
contains no ActiveRecord references. If this happens, add an ActiveRecord
adapter dependency such as <code class="docutils literal notranslate"><span class="pre">sqlite3</span></code> to your <code class="docutils literal notranslate"><span class="pre">Gemfile</span></code> so that
ActiveRecord may be completely loaded or remove Spring from your
application.</p>
</div>
</section>
<section id="mongoid-configuration">
<h3>Mongoid Configuration<a class="headerlink" href="#mongoid-configuration" title="Permalink to this headline">#</a></h3>
<p>Generate the default Mongoid configuration:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bin/rails g mongoid:config
</pre></div>
</div>
<p>This generator will create the <code class="docutils literal notranslate"><span class="pre">config/mongoid.yml</span></code> configuration file,
which is used to configure the connection to the MongoDB deployment.</p>
<p>Review the sections <a class="reference internal" href="#run-mongodb-locally">Run MongoDB Locally</a> and <a class="reference internal" href="#use-mongodb-atlas">Use MongoDB Atlas</a>
to decide how you would like to deploy MongoDB, and adjust Mongoid
configuration (<code class="docutils literal notranslate"><span class="pre">config/mongoid.yml</span></code>) to match.</p>
</section>
<section id="adjust-models">
<h3>Adjust Models<a class="headerlink" href="#adjust-models" title="Permalink to this headline">#</a></h3>
<p>If your application already has models, these will need to be changed when
migrating from ActiveRecord to Mongoid.</p>
<p>ActiveRecord models derive from <code class="docutils literal notranslate"><span class="pre">ApplicationRecord</span></code> and do not have
column definitions. Mongoid models generally have no superclass but must
include <code class="docutils literal notranslate"><span class="pre">Mongoid::Document</span></code>, and usually define the fields explicitly
(but <a class="reference internal" href="../reference/fields.html#dynamic-fields"><span class="std std-ref">dynamic fields</span></a> may also be used instead of
explicit field definitions).</p>
<p>For example, a bare-bones Post model may look like this in ActiveRecord:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">app/models/post.rb</span><a class="headerlink" href="#id2" title="Permalink to this code">#</a></div>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Post</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:comments</span><span class="p">,</span> <span class="ss">dependent</span><span class="p">:</span> <span class="ss">:destroy</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<p>The same model may look like this in Mongoid:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">app/models/post.rb</span><a class="headerlink" href="#id3" title="Permalink to this code">#</a></div>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Post</span>
  <span class="kp">include</span> <span class="no">Mongoid</span><span class="o">::</span><span class="no">Document</span>

  <span class="n">field</span> <span class="ss">:title</span><span class="p">,</span> <span class="ss">type</span><span class="p">:</span> <span class="nb">String</span>
  <span class="n">field</span> <span class="ss">:body</span><span class="p">,</span> <span class="ss">type</span><span class="p">:</span> <span class="nb">String</span>

  <span class="n">has_many</span> <span class="ss">:comments</span><span class="p">,</span> <span class="ss">dependent</span><span class="p">:</span> <span class="ss">:destroy</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<p>Or like this with dynamic fields:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">app/models/post.rb</span><a class="headerlink" href="#id4" title="Permalink to this code">#</a></div>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Post</span>
  <span class="kp">include</span> <span class="no">Mongoid</span><span class="o">::</span><span class="no">Document</span>
  <span class="kp">include</span> <span class="no">Mongoid</span><span class="o">::</span><span class="no">Attributes</span><span class="o">::</span><span class="no">Dynamic</span>

  <span class="n">has_many</span> <span class="ss">:comments</span><span class="p">,</span> <span class="ss">dependent</span><span class="p">:</span> <span class="ss">:destroy</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<p>Mongoid does not utilize ActiveRecord migrations, since MongoDB does not
require a schema to be defined prior to storing data.</p>
</section>
<section id="data-migration">
<h3>Data Migration<a class="headerlink" href="#data-migration" title="Permalink to this headline">#</a></h3>
<p>If you already have data in a relational database that you would like to
transfer to MongoDB, you will need to perform a data migration. As noted
above, no schema migration is necessary because MongoDB does not require
a predefined schema to store the data.</p>
<p>The migration tools are often specific to the data being migrated because,
even though Mongoid supports a superset of ActiveRecord associations,
the way that model references are stored in collections differs between
Mongoid and ActiveRecord. With that said, MongoDB has
some resources on migrating from an RDBMS to MongoDB such as the
<a class="reference external" href="https://s3.amazonaws.com/info-mongodb-com/RDBMStoMongoDBMigration.pdf">RDBMS to MongoDB Migration Guide</a> and
<a class="reference external" href="https://www.mongodb.com/modernize">Modernization Guide</a>.</p>
</section>
<section id="rails-api">
<h3>Rails API<a class="headerlink" href="#rails-api" title="Permalink to this headline">#</a></h3>
<p>The process for creating a Rails API application with Mongoid is the same
as when creating a regular application, with the only change being the
<code class="docutils literal notranslate"><span class="pre">--api</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">rails</span> <span class="pre">new</span></code>. Migrating a Rails API application to
Mongoid follows the same process described above for regular Rails applications.</p>
<p>A complete Rails API application similar to the one described in this tutorial
can be found in the <a class="reference external" href="https://github.com/mongoid/mongoid-demo/tree/master/rails-api">mongoid-demo GitHub repository</a>.</p>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="getting-started-sinatra.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Getting Started (Sinatra)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="documents.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Documents</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
      &copy; Copyright 2021, MongoDB.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>