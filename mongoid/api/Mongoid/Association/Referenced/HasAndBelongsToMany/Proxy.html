<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Mongoid::Association::Referenced::HasAndBelongsToMany::Proxy
  
    &mdash; mongoid-7.3.0.alpha
  
</title>

  <link rel="stylesheet" href="../../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Mongoid::Association::Referenced::HasAndBelongsToMany::Proxy";
  relpath = '../../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../../_index.html">Index (P)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../Mongoid.html" title="Mongoid (module)">Mongoid</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Association.html" title="Mongoid::Association (module)">Association</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Referenced.html" title="Mongoid::Association::Referenced (module)">Referenced</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../HasAndBelongsToMany.html" title="Mongoid::Association::Referenced::HasAndBelongsToMany (class)">HasAndBelongsToMany</a></span></span>
     &raquo; 
    <span class="title">Proxy</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Mongoid::Association::Referenced::HasAndBelongsToMany::Proxy
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="../HasMany/Proxy.html" title="Mongoid::Association::Referenced::HasMany::Proxy (class)">Mongoid::Association::Referenced::HasMany::Proxy</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="../../Proxy.html" title="Mongoid::Association::Proxy (class)">Proxy</a></span></li>
          
            <li class="next"><span class='object_link'><a href="../../Many.html" title="Mongoid::Association::Many (class)">Many</a></span></li>
          
            <li class="next"><span class='object_link'><a href="../HasMany/Proxy.html" title="Mongoid::Association::Referenced::HasMany::Proxy (class)">Mongoid::Association::Referenced::HasMany::Proxy</a></span></li>
          
            <li class="next">Mongoid::Association::Referenced::HasAndBelongsToMany::Proxy</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/mongoid/association/referenced/has_and_belongs_to_many/proxy.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This class defines the behavior for all associations that are a many-to-many between documents in different collections.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>7.0</p>
</div>
      
    </li>
  
</ul>

</div>





  <h2>Instance Attribute Summary</h2>
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="../../Proxy.html" title="Mongoid::Association::Proxy (class)">Proxy</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Proxy.html#_association-instance_method" title="Mongoid::Association::Proxy#_association (method)">#_association</a></span>, <span class='object_link'><a href="../../Proxy.html#_base-instance_method" title="Mongoid::Association::Proxy#_base (method)">#_base</a></span>, <span class='object_link'><a href="../../Proxy.html#_target-instance_method" title="Mongoid::Association::Proxy#_target (method)">#_target</a></span></p>


  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#eager_loader-class_method" title="eager_loader (class method)">.<strong>eager_loader</strong>(association, docs)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the Eager object for this type of association.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#embedded%3F-class_method" title="embedded? (class method)">.<strong>embedded?</strong>  &#x21d2; false </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns true if the association is an embedded one.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#<<-instance_method" title="#&lt;&lt; (instance method)">#<strong>&lt;&lt;</strong>(*args)  &#x21d2; Array&lt;Document&gt; </a>
    

    
      (also: #push)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Appends a document or array of documents to the association.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build-instance_method" title="#build (instance method)">#<strong>build</strong>(attributes = {}, type = nil) {|doc| ... } &#x21d2; Document </a>
    

    
      (also: #new)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Build a new document from the attributes and append it to this association without saving.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#concat-instance_method" title="#concat (instance method)">#<strong>concat</strong>(documents)  &#x21d2; Array&lt;Document&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Appends an array of documents to the association.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete-instance_method" title="#delete (instance method)">#<strong>delete</strong>(document)  &#x21d2; Document </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Delete the document from the association.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#nullify-instance_method" title="#nullify (instance method)">#<strong>nullify</strong>(replacement = [])  &#x21d2; Object </a>
    

    
      (also: #nullify_all, #clear, #purge)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Removes all associations between the base document and the target documents by deleting the foreign keys and the references, orphaning the target documents in the process.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#substitute-instance_method" title="#substitute (instance method)">#<strong>substitute</strong>(replacement)  &#x21d2; Many </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Substitutes the supplied target documents for the existing documents in the association.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unscoped-instance_method" title="#unscoped (instance method)">#<strong>unscoped</strong>  &#x21d2; Criteria </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get a criteria for the documents without the default scoping applied.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="../HasMany/Proxy.html" title="Mongoid::Association::Referenced::HasMany::Proxy (class)">Mongoid::Association::Referenced::HasMany::Proxy</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../HasMany/Proxy.html#delete_all-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#delete_all (method)">#delete_all</a></span>, <span class='object_link'><a href="../HasMany/Proxy.html#destroy_all-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#destroy_all (method)">#destroy_all</a></span>, <span class='object_link'><a href="../HasMany/Proxy.html#each-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#each (method)">#each</a></span>, <span class='object_link'><a href="../HasMany/Proxy.html#exists%3F-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#exists? (method)">#exists?</a></span>, <span class='object_link'><a href="../HasMany/Proxy.html#find-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#find (method)">#find</a></span>, <span class='object_link'><a href="../HasMany/Proxy.html#initialize-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#initialize (method)">#initialize</a></span></p>

  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="../../Many.html" title="Mongoid::Association::Many (class)">Many</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Many.html#blank%3F-instance_method" title="Mongoid::Association::Many#blank? (method)">#blank?</a></span>, <span class='object_link'><a href="../../Many.html#create-instance_method" title="Mongoid::Association::Many#create (method)">#create</a></span>, <span class='object_link'><a href="../../Many.html#create!-instance_method" title="Mongoid::Association::Many#create! (method)">#create!</a></span>, <span class='object_link'><a href="../../Many.html#find_or_create_by-instance_method" title="Mongoid::Association::Many#find_or_create_by (method)">#find_or_create_by</a></span>, <span class='object_link'><a href="../../Many.html#find_or_create_by!-instance_method" title="Mongoid::Association::Many#find_or_create_by! (method)">#find_or_create_by!</a></span>, <span class='object_link'><a href="../../Many.html#find_or_initialize_by-instance_method" title="Mongoid::Association::Many#find_or_initialize_by (method)">#find_or_initialize_by</a></span>, <span class='object_link'><a href="../../Many.html#nil%3F-instance_method" title="Mongoid::Association::Many#nil? (method)">#nil?</a></span>, <span class='object_link'><a href="../../Many.html#respond_to%3F-instance_method" title="Mongoid::Association::Many#respond_to? (method)">#respond_to?</a></span>, <span class='object_link'><a href="../../Many.html#scoped-instance_method" title="Mongoid::Association::Many#scoped (method)">#scoped</a></span>, <span class='object_link'><a href="../../Many.html#serializable_hash-instance_method" title="Mongoid::Association::Many#serializable_hash (method)">#serializable_hash</a></span></p>

  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="../../Proxy.html" title="Mongoid::Association::Proxy (class)">Proxy</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Proxy.html#apply_ordering-class_method" title="Mongoid::Association::Proxy.apply_ordering (method)">apply_ordering</a></span>, <span class='object_link'><a href="../../Proxy.html#extend_proxies-instance_method" title="Mongoid::Association::Proxy#extend_proxies (method)">#extend_proxies</a></span>, <span class='object_link'><a href="../../Proxy.html#init-instance_method" title="Mongoid::Association::Proxy#init (method)">#init</a></span>, <span class='object_link'><a href="../../Proxy.html#klass-instance_method" title="Mongoid::Association::Proxy#klass (method)">#klass</a></span>, <span class='object_link'><a href="../../Proxy.html#reset_unloaded-instance_method" title="Mongoid::Association::Proxy#reset_unloaded (method)">#reset_unloaded</a></span>, <span class='object_link'><a href="../../Proxy.html#substitutable-instance_method" title="Mongoid::Association::Proxy#substitutable (method)">#substitutable</a></span></p>

  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../Marshalable.html" title="Mongoid::Association::Marshalable (module)">Marshalable</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Marshalable.html#marshal_dump-instance_method" title="Mongoid::Association::Marshalable#marshal_dump (method)">#marshal_dump</a></span>, <span class='object_link'><a href="../../Marshalable.html#marshal_load-instance_method" title="Mongoid::Association::Marshalable#marshal_load (method)">#marshal_load</a></span></p>

  
  
  
  
  
  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <p class="notice">This class inherits a constructor from <span class='object_link'><a href="../HasMany/Proxy.html#initialize-instance_method" title="Mongoid::Association::Referenced::HasMany::Proxy#initialize (method)">Mongoid::Association::Referenced::HasMany::Proxy</a></span></p>
  
</div>
<div id="method_missing_details" class="method_details_list">
  <h2>Dynamic Method Handling</h2>
  <p class="notice super">
    This class handles dynamic methods through the <tt>method_missing</tt> method
    
      in the class <span class='object_link'>Mongoid::Association::Referenced::HasMany::Proxy</span>
    
  </p>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="eager_loader-class_method">
  
    .<strong>eager_loader</strong>(association, docs)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the Eager object for this type of association.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Get the eager loader object</p>
</div></p>
      
      <pre class="example code"><code></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>association</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Association.html" title="Mongoid::Association (module)">Association</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The association object.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>docs</span>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The array of documents.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>7.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


298
299
300</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongoid/association/referenced/has_and_belongs_to_many/proxy.rb', line 298</span>

<span class='kw'>def</span> <span class='id identifier rubyid_eager_loader'>eager_loader</span><span class='lparen'>(</span><span class='id identifier rubyid_association'>association</span><span class='comma'>,</span> <span class='id identifier rubyid_docs'>docs</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Eager.html" title="Mongoid::Association::Referenced::HasAndBelongsToMany::Eager (class)">Eager</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Eager/Base.html#initialize-instance_method" title="Mongoid::Association::Referenced::Eager::Base#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_association'>association</span><span class='comma'>,</span> <span class='id identifier rubyid_docs'>docs</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="embedded?-class_method">
  
    .<strong>embedded?</strong>  &#x21d2; <tt>false</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns true if the association is an embedded one. In this case always false.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Is this association embedded?</p>
</div></p>
      
      <pre class="example code"><code><span class='const'><span class='object_link'><a href="../../Referenced.html" title="Mongoid::Association::Referenced (module)">Referenced</a></span></span><span class='op'>::</span><span class='const'>ManyToMany</span><span class='period'>.</span><span class='id identifier rubyid_embedded?'>embedded?</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Always false.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0.rc.1</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


311
312
313</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongoid/association/referenced/has_and_belongs_to_many/proxy.rb', line 311</span>

<span class='kw'>def</span> <span class='id identifier rubyid_embedded?'>embedded?</span>
  <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="<<-instance_method">
  
    #<strong>&lt;&lt;</strong>(*args)  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span>&gt;</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='push-instance_method'>push</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Appends a document or array of documents to the association. Will set the parent and update the index in the process.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Append a document.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_person'>person</span><span class='period'>.</span><span class='id identifier rubyid_posts'>posts</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_post'>post</span></code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>Push a document.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_person'>person</span><span class='period'>.</span><span class='id identifier rubyid_posts'>posts</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_post'>post</span><span class='rparen'>)</span></code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>Concat with other documents.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_person'>person</span><span class='period'>.</span><span class='id identifier rubyid_posts'>posts</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='lbracket'>[</span> <span class='id identifier rubyid_post_one'>post_one</span><span class='comma'>,</span> <span class='id identifier rubyid_post_two'>post_two</span> <span class='rbracket'>]</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span></tt>, <tt>Array&lt;<span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Any number of documents.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The loaded docs.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0.beta.1</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


30
31
32
33
34
35
36
37
38
39
40
41</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongoid/association/referenced/has_and_belongs_to_many/proxy.rb', line 30</span>

<span class='kw'>def</span> <span class='op'>&lt;&lt;</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_docs'>docs</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_docs'>docs</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_docs'>docs</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_doc'>doc</span> <span class='op'>=</span> <span class='id identifier rubyid_docs'>docs</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='id identifier rubyid_doc'>doc</span><span class='rparen'>)</span>
    <span class='id identifier rubyid__base'>_base</span><span class='period'>.</span><span class='id identifier rubyid_add_to_set'>add_to_set</span><span class='lparen'>(</span><span class='id identifier rubyid_foreign_key'>foreign_key</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_doc'>doc</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid__association'>_association</span><span class='period'>.</span><span class='id identifier rubyid_primary_key'>primary_key</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_child_persistable?'>child_persistable?</span><span class='lparen'>(</span><span class='id identifier rubyid_doc'>doc</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_doc'>doc</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_unsynced'>unsynced</span><span class='lparen'>(</span><span class='id identifier rubyid__base'>_base</span><span class='comma'>,</span> <span class='id identifier rubyid_foreign_key'>foreign_key</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="build-instance_method">
  
    #<strong>build</strong>(attributes = {}, type = nil) {|doc| ... } &#x21d2; <tt><span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span></tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='new-instance_method'>new</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Build a new document from the attributes and append it to this association without saving.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Build a new document on the association.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_person'>person</span><span class='period'>.</span><span class='id identifier rubyid_posts'>posts</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='symbol'>:title</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A new post</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>attributes</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The attributes of the new document.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>Class</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The optional subclass to build.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>doc</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The new document.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0.beta.1</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


90
91
92
93
94
95
96
97
98</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongoid/association/referenced/has_and_belongs_to_many/proxy.rb', line 90</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_doc'>doc</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Factory.html" title="Mongoid::Factory (module)">Factory</a></span></span><span class='period'>.</span><span class='id identifier rubyid_build'><span class='object_link'><a href="../../../Factory.html#build-instance_method" title="Mongoid::Factory#build (method)">build</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span> <span class='op'>||</span> <span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid__base'>_base</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid_foreign_key'>foreign_key</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_doc'>doc</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='id identifier rubyid_doc'>doc</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_doc'>doc</span><span class='period'>.</span><span class='id identifier rubyid_apply_post_processed_defaults'>apply_post_processed_defaults</span>
  <span class='id identifier rubyid_unsynced'>unsynced</span><span class='lparen'>(</span><span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> <span class='id identifier rubyid_inverse_foreign_key'>inverse_foreign_key</span><span class='rparen'>)</span>
  <span class='kw'>yield</span><span class='lparen'>(</span><span class='id identifier rubyid_doc'>doc</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='id identifier rubyid_doc'>doc</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="concat-instance_method">
  
    #<strong>concat</strong>(documents)  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Appends an array of documents to the association. Performs a batch insert of the documents instead of persisting one at a time.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Concat with other documents.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_person'>person</span><span class='period'>.</span><span class='id identifier rubyid_posts'>posts</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='lbracket'>[</span> <span class='id identifier rubyid_post_one'>post_one</span><span class='comma'>,</span> <span class='id identifier rubyid_post_two'>post_two</span> <span class='rbracket'>]</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>documents</span>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The docs to add.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The documents.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.4.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongoid/association/referenced/has_and_belongs_to_many/proxy.rb', line 56</span>

<span class='kw'>def</span> <span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_documents'>documents</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ids'>ids</span><span class='comma'>,</span> <span class='id identifier rubyid_docs'>docs</span><span class='comma'>,</span> <span class='id identifier rubyid_inserts'>inserts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_documents'>documents</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_doc'>doc</span>
    <span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='id identifier rubyid_doc'>doc</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_persistable?'>persistable?</span> <span class='op'>||</span> <span class='id identifier rubyid__creating?'>_creating?</span>
      <span class='id identifier rubyid_ids'>ids</span><span class='lbracket'>[</span><span class='id identifier rubyid_doc'>doc</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_save_or_delay'>save_or_delay</span><span class='lparen'>(</span><span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> <span class='id identifier rubyid_docs'>docs</span><span class='comma'>,</span> <span class='id identifier rubyid_inserts'>inserts</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_existing'>existing</span> <span class='op'>=</span> <span class='id identifier rubyid__base'>_base</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid_foreign_key'>foreign_key</span><span class='rparen'>)</span>
      <span class='kw'>unless</span> <span class='id identifier rubyid_existing'>existing</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_doc'>doc</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_existing'>existing</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_doc'>doc</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='id identifier rubyid_unsynced'>unsynced</span><span class='lparen'>(</span><span class='id identifier rubyid__base'>_base</span><span class='comma'>,</span> <span class='id identifier rubyid_foreign_key'>foreign_key</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_persistable?'>persistable?</span> <span class='op'>||</span> <span class='id identifier rubyid__creating?'>_creating?</span>
    <span class='id identifier rubyid__base'>_base</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_foreign_key'>foreign_key</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_ids'>ids</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_persist_delayed'>persist_delayed</span><span class='lparen'>(</span><span class='id identifier rubyid_docs'>docs</span><span class='comma'>,</span> <span class='id identifier rubyid_inserts'>inserts</span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete-instance_method">
  
    #<strong>delete</strong>(document)  &#x21d2; <tt><span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Delete the document from the association. This will set the foreign key on the document to nil. If the dependent options on the association are :delete_all or :destroy the appropriate removal will occur.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Delete the document.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_person'>person</span><span class='period'>.</span><span class='id identifier rubyid_posts'>posts</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_post'>post</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>document</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The document to remove.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The matching document.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.1.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


114
115
116
117
118
119
120
121
122</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongoid/association/referenced/has_and_belongs_to_many/proxy.rb', line 114</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_document'>document</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_doc'>doc</span> <span class='op'>=</span> <span class='kw'>super</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_doc'>doc</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_persistable?'>persistable?</span>
    <span class='id identifier rubyid__base'>_base</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span><span class='lparen'>(</span><span class='id identifier rubyid_foreign_key'>foreign_key</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_doc'>doc</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid__association'>_association</span><span class='period'>.</span><span class='id identifier rubyid_primary_key'>primary_key</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid__target'>_target</span><span class='period'>.</span><span class='id identifier rubyid__unloaded'>_unloaded</span> <span class='op'>=</span> <span class='id identifier rubyid_criteria'>criteria</span>
    <span class='id identifier rubyid_unsynced'>unsynced</span><span class='lparen'>(</span><span class='id identifier rubyid__base'>_base</span><span class='comma'>,</span> <span class='id identifier rubyid_foreign_key'>foreign_key</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_doc'>doc</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="nullify-instance_method">
  
    #<strong>nullify</strong>(replacement = [])  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='nullify_all-instance_method'>nullify_all</span>, <span id='clear-instance_method'>clear</span>, <span id='purge-instance_method'>purge</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Removes all associations between the base document and the target documents by deleting the foreign keys and the references, orphaning the target documents in the process.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Nullify the association.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_person'>person</span><span class='period'>.</span><span class='id identifier rubyid_preferences'>preferences</span><span class='period'>.</span><span class='id identifier rubyid_nullify'>nullify</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>replacement</span>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span>&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>[]</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The replacement documents.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0.rc.1</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongoid/association/referenced/has_and_belongs_to_many/proxy.rb', line 134</span>

<span class='kw'>def</span> <span class='id identifier rubyid_nullify'>nullify</span><span class='lparen'>(</span><span class='id identifier rubyid_replacement'>replacement</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid__target'>_target</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span>
    <span class='id identifier rubyid_execute_callback'>execute_callback</span> <span class='symbol'>:before_remove</span><span class='comma'>,</span> <span class='id identifier rubyid_doc'>doc</span>
  <span class='kw'>end</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid__association'>_association</span><span class='period'>.</span><span class='id identifier rubyid_forced_nil_inverse?'>forced_nil_inverse?</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_field'>field</span> <span class='op'>=</span> <span class='id identifier rubyid__association'>_association</span><span class='period'>.</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:inverse_primary_key</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_ipk'>ipk</span> <span class='op'>=</span> <span class='id identifier rubyid__base'>_base</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid_field'>field</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_ipk'>ipk</span> <span class='op'>=</span> <span class='id identifier rubyid__base'>_base</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_replacement'>replacement</span>
      <span class='id identifier rubyid_objects_to_clear'>objects_to_clear</span> <span class='op'>=</span> <span class='id identifier rubyid__base'>_base</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid_foreign_key'>foreign_key</span><span class='rparen'>)</span> <span class='op'>-</span> <span class='id identifier rubyid_replacement'>replacement</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_object'>object</span><span class='op'>|</span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid__association'>_association</span><span class='period'>.</span><span class='id identifier rubyid_primary_key'>primary_key</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_criteria'>criteria</span><span class='lparen'>(</span><span class='id identifier rubyid_objects_to_clear'>objects_to_clear</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span><span class='lparen'>(</span><span class='id identifier rubyid_inverse_foreign_key'>inverse_foreign_key</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_ipk'>ipk</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_criteria'>criteria</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span><span class='lparen'>(</span><span class='id identifier rubyid_inverse_foreign_key'>inverse_foreign_key</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_ipk'>ipk</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_persistable?'>persistable?</span>
    <span class='id identifier rubyid__base'>_base</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span><span class='lparen'>(</span><span class='id identifier rubyid_foreign_key'>foreign_key</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid__base'>_base</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid_foreign_key'>foreign_key</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_after_remove_error'>after_remove_error</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_many_to_many'>many_to_many</span> <span class='op'>=</span> <span class='id identifier rubyid__target'>_target</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_doc'>doc</span><span class='op'>|</span>
    <span class='id identifier rubyid_unbind_one'>unbind_one</span><span class='lparen'>(</span><span class='id identifier rubyid_doc'>doc</span><span class='rparen'>)</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid__association'>_association</span><span class='period'>.</span><span class='id identifier rubyid_forced_nil_inverse?'>forced_nil_inverse?</span>
      <span class='id identifier rubyid_doc'>doc</span><span class='period'>.</span><span class='id identifier rubyid_changed_attributes'>changed_attributes</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_inverse_foreign_key'>inverse_foreign_key</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_execute_callback'>execute_callback</span> <span class='symbol'>:after_remove</span><span class='comma'>,</span> <span class='id identifier rubyid_doc'>doc</span>
    <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
      <span class='id identifier rubyid_after_remove_error'>after_remove_error</span> <span class='op'>=</span> <span class='id identifier rubyid_e'>e</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_after_remove_error'>after_remove_error</span> <span class='kw'>if</span> <span class='id identifier rubyid_after_remove_error'>after_remove_error</span>
  <span class='id identifier rubyid_many_to_many'>many_to_many</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="substitute-instance_method">
  
    #<strong>substitute</strong>(replacement)  &#x21d2; <tt><span class='object_link'><a href="../../Many.html" title="Mongoid::Association::Many (class)">Many</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Substitutes the supplied target documents for the existing documents in the association. If the new target is nil, perform the necessary deletion.</p>

<p>person.preferences.substitute([ new_post ])</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Replace the association.</p>
</div></p>
      
      <pre class="example code"><code></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>replacement</span>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="../../../Document.html" title="Mongoid::Document (module)">Document</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The replacement target.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Many.html" title="Mongoid::Association::Many (class)">Many</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The association.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.0.0.rc.1</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


188
189
190
191
192
193
194
195
196</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongoid/association/referenced/has_and_belongs_to_many/proxy.rb', line 188</span>

<span class='kw'>def</span> <span class='id identifier rubyid_substitute'>substitute</span><span class='lparen'>(</span><span class='id identifier rubyid_replacement'>replacement</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_purge'>purge</span><span class='lparen'>(</span><span class='id identifier rubyid_replacement'>replacement</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_replacement'>replacement</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
    <span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_replacement'>replacement</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_reset_unloaded'>reset_unloaded</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unscoped-instance_method">
  
    #<strong>unscoped</strong>  &#x21d2; <tt><span class='object_link'><a href="../../../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get a criteria for the documents without the default scoping applied.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Get the unscoped criteria.</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_person'>person</span><span class='period'>.</span><span class='id identifier rubyid_preferences'>preferences</span><span class='period'>.</span><span class='id identifier rubyid_unscoped'>unscoped</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Criteria.html" title="Mongoid::Criteria (class)">Criteria</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The unscoped criteria.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>2.4.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


207
208
209</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mongoid/association/referenced/has_and_belongs_to_many/proxy.rb', line 207</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unscoped'>unscoped</span>
  <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_unscoped'>unscoped</span><span class='period'>.</span><span class='id identifier rubyid_any_in'>any_in</span><span class='lparen'>(</span><span class='label'>_id:</span> <span class='id identifier rubyid__base'>_base</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid_foreign_key'>foreign_key</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Dec 23 02:22:06 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.25 (ruby-2.7.2).
</div>

    </div>
  </body>
</html>